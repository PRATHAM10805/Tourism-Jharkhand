"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/feedback/route";
exports.ids = ["app/api/feedback/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@14.2.32_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ffeedback%2Froute&page=%2Fapi%2Ffeedback%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ffeedback%2Froute.ts&appDir=C%3A%5CUsers%5CPrachi%5CDesktop%5CSIH%202025%5CTourism-Jharkhand%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CPrachi%5CDesktop%5CSIH%202025%5CTourism-Jharkhand&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@14.2.32_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ffeedback%2Froute&page=%2Fapi%2Ffeedback%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ffeedback%2Froute.ts&appDir=C%3A%5CUsers%5CPrachi%5CDesktop%5CSIH%202025%5CTourism-Jharkhand%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CPrachi%5CDesktop%5CSIH%202025%5CTourism-Jharkhand&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@14.2.32_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/.pnpm/next@14.2.32_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@14.2.32_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Prachi_Desktop_SIH_2025_Tourism_Jharkhand_app_api_feedback_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/feedback/route.ts */ \"(rsc)/./app/api/feedback/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/feedback/route\",\n        pathname: \"/api/feedback\",\n        filename: \"route\",\n        bundlePath: \"app/api/feedback/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Prachi\\\\Desktop\\\\SIH 2025\\\\Tourism-Jharkhand\\\\app\\\\api\\\\feedback\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Prachi_Desktop_SIH_2025_Tourism_Jharkhand_app_api_feedback_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/feedback/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNC4yLjMyX3JlYWN0LWRvbUAxOC4zLjFfcmVhY3RAMTguMy4xX19yZWFjdEAxOC4zLjEvbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyLmpzP25hbWU9YXBwJTJGYXBpJTJGZmVlZGJhY2slMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmZlZWRiYWNrJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGZmVlZGJhY2slMkZyb3V0ZS50cyZhcHBEaXI9QyUzQSU1Q1VzZXJzJTVDUHJhY2hpJTVDRGVza3RvcCU1Q1NJSCUyMDIwMjUlNUNUb3VyaXNtLUpoYXJraGFuZCU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDUHJhY2hpJTVDRGVza3RvcCU1Q1NJSCUyMDIwMjUlNUNUb3VyaXNtLUpoYXJraGFuZCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDcUM7QUFDbEg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Lz82MjYwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXFByYWNoaVxcXFxEZXNrdG9wXFxcXFNJSCAyMDI1XFxcXFRvdXJpc20tSmhhcmtoYW5kXFxcXGFwcFxcXFxhcGlcXFxcZmVlZGJhY2tcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2ZlZWRiYWNrL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvZmVlZGJhY2tcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2ZlZWRiYWNrL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcUHJhY2hpXFxcXERlc2t0b3BcXFxcU0lIIDIwMjVcXFxcVG91cmlzbS1KaGFya2hhbmRcXFxcYXBwXFxcXGFwaVxcXFxmZWVkYmFja1xcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvZmVlZGJhY2svcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@14.2.32_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ffeedback%2Froute&page=%2Fapi%2Ffeedback%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ffeedback%2Froute.ts&appDir=C%3A%5CUsers%5CPrachi%5CDesktop%5CSIH%202025%5CTourism-Jharkhand%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CPrachi%5CDesktop%5CSIH%202025%5CTourism-Jharkhand&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/feedback/route.ts":
/*!***********************************!*\
  !*** ./app/api/feedback/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/.pnpm/next@14.2.32_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_ai_services__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/ai-services */ \"(rsc)/./lib/ai-services.ts\");\n\n\n// Real-time alert system\nclass AlertSystem {\n    static async triggerAlert(feedback) {\n        if (feedback.urgencyLevel === \"critical\" || feedback.urgencyLevel === \"high\") {\n            // In production, this would send real notifications\n            console.log(`🚨 CRITICAL ALERT: ${feedback.location} - ${feedback.category}`);\n            console.log(`Issue: ${feedback.aiAnalysis.actionableInsights?.join(\", \")}`);\n            // Auto-generate response for critical issues\n            feedback.autoResponseGenerated = await this.generateAutoResponse(feedback);\n            feedback.escalated = true;\n        }\n    }\n    static async generateAutoResponse(feedback) {\n        const insights = feedback.aiAnalysis.actionableInsights || [];\n        if (insights.some((i)=>i.includes(\"URGENT\") || i.includes(\"Safety\"))) {\n            return `Thank you for bringing this safety concern to our attention. We have immediately escalated this issue to our safety team and will address it within 24 hours. Your safety is our top priority.`;\n        }\n        if (feedback.aiAnalysis.sentiment === \"negative\" && feedback.aiAnalysis.confidence > 0.8) {\n            return `We sincerely apologize for your disappointing experience. We have forwarded your feedback to the relevant team for immediate action. We will contact you within 48 hours with an update on the improvements being made.`;\n        }\n        return `Thank you for your valuable feedback. We appreciate you taking the time to share your experience with us.`;\n    }\n}\n// Advanced AI-powered feedback analysis\nasync function analyzeAdvancedFeedback(textFeedback, voiceBlob, imageBlob, language = \"auto\") {\n    try {\n        const results = {};\n        // Analyze text if provided\n        if (textFeedback) {\n            results.aiAnalysis = await _lib_ai_services__WEBPACK_IMPORTED_MODULE_1__.aiService.analyzeText(textFeedback, language);\n        }\n        // Analyze voice if provided\n        if (voiceBlob) {\n            results.voiceAnalysis = await _lib_ai_services__WEBPACK_IMPORTED_MODULE_1__.aiService.analyzeVoice(voiceBlob);\n            // If no text feedback, use voice transcription for text analysis\n            if (!textFeedback && results.voiceAnalysis.transcription) {\n                results.aiAnalysis = await _lib_ai_services__WEBPACK_IMPORTED_MODULE_1__.aiService.analyzeText(results.voiceAnalysis.transcription, language);\n            }\n        }\n        // Analyze image if provided\n        if (imageBlob) {\n            results.imageAnalysis = await _lib_ai_services__WEBPACK_IMPORTED_MODULE_1__.aiService.analyzeImage(imageBlob);\n        }\n        return results;\n    } catch (error) {\n        console.error(\"Advanced feedback analysis failed:\", error);\n        // Fallback analysis\n        if (textFeedback) {\n            return {\n                aiAnalysis: await _lib_ai_services__WEBPACK_IMPORTED_MODULE_1__.aiService.analyzeText(textFeedback, language)\n            };\n        }\n        throw error;\n    }\n}\n// Real-time sentiment monitoring\nclass SentimentMonitor {\n    static{\n        this.sentimentHistory = [];\n    }\n    static addSentiment(feedback) {\n        this.sentimentHistory.push({\n            timestamp: feedback.timestamp,\n            sentiment: feedback.aiAnalysis.sentiment,\n            confidence: feedback.aiAnalysis.confidence,\n            location: feedback.location,\n            category: feedback.category\n        });\n        // Keep only last 1000 entries\n        if (this.sentimentHistory.length > 1000) {\n            this.sentimentHistory = this.sentimentHistory.slice(-1000);\n        }\n        // Check for sentiment trends\n        this.checkSentimentTrends(feedback.location, feedback.category);\n    }\n    static checkSentimentTrends(location, category) {\n        const recentFeedbacks = this.sentimentHistory.filter((s)=>s.location === location && s.category === category).slice(-10) // Last 10 feedbacks for this location/category\n        ;\n        if (recentFeedbacks.length >= 5) {\n            const negativeFeedbacks = recentFeedbacks.filter((s)=>s.sentiment === \"negative\");\n            if (negativeFeedbacks.length >= 3) {\n                console.log(`⚠️ TREND ALERT: Increasing negative sentiment detected for ${location} - ${category}`);\n            // In production, this would trigger notifications to tourism officials\n            }\n        }\n    }\n    static getSentimentTrends(location, category) {\n        let filtered = this.sentimentHistory;\n        if (location) {\n            filtered = filtered.filter((s)=>s.location === location);\n        }\n        if (category) {\n            filtered = filtered.filter((s)=>s.category === category);\n        }\n        return filtered.slice(-30) // Last 30 entries\n        ;\n    }\n}\n// AI-powered chatbot for instant responses\nclass FeedbackChatbot {\n    static async generateResponse(feedback) {\n        const { aiAnalysis, location, category } = feedback;\n        // Generate contextual response based on AI analysis\n        if (aiAnalysis.urgency === \"critical\") {\n            return `Thank you for this critical feedback about ${location}. We are immediately addressing the ${aiAnalysis.categories?.join(\", \")} issues you've mentioned. A senior official will contact you within 2 hours.`;\n        }\n        if (aiAnalysis.sentiment === \"positive\") {\n            return `We're delighted to hear about your positive experience at ${location}! Thank you for highlighting ${aiAnalysis.keywords.slice(0, 3).join(\", \")}. We'll share your feedback with our team.`;\n        }\n        if (aiAnalysis.sentiment === \"negative\") {\n            const issues = aiAnalysis.actionableInsights?.slice(0, 2).join(\" and \") || \"the issues you mentioned\";\n            return `We sincerely apologize for your experience at ${location}. We're taking immediate action on ${issues}. You can expect an update within 24-48 hours.`;\n        }\n        return `Thank you for your feedback about ${location}. Your insights about ${category.toLowerCase()} are valuable for improving our tourism services.`;\n    }\n    static async generateFollowUpQuestions(feedback) {\n        const questions = [];\n        if (feedback.aiAnalysis.sentiment === \"negative\") {\n            questions.push(\"What specific steps would you like to see implemented to improve this experience?\");\n            questions.push(\"Would you be willing to revisit this location if improvements were made?\");\n        }\n        if (feedback.aiAnalysis.categories?.includes(\"service quality\")) {\n            questions.push(\"Can you provide more details about the staff interaction?\");\n        }\n        if (feedback.aiAnalysis.categories?.includes(\"cleanliness\")) {\n            questions.push(\"Which specific areas need attention regarding cleanliness?\");\n        }\n        return questions.slice(0, 3);\n    }\n}\n// Fallback rule-based sentiment analysis\nfunction fallbackSentimentAnalysis(text, language) {\n    const positiveWords = [\n        \"good\",\n        \"great\",\n        \"excellent\",\n        \"amazing\",\n        \"wonderful\",\n        \"beautiful\",\n        \"love\",\n        \"perfect\",\n        \"awesome\",\n        \"fantastic\"\n    ];\n    const negativeWords = [\n        \"bad\",\n        \"terrible\",\n        \"awful\",\n        \"horrible\",\n        \"hate\",\n        \"worst\",\n        \"disappointing\",\n        \"poor\",\n        \"dirty\",\n        \"unsafe\"\n    ];\n    // Hindi positive/negative words\n    const hindiPositive = [\n        \"अच्छा\",\n        \"बहुत\",\n        \"सुंदर\",\n        \"खुश\",\n        \"प्रसन्न\",\n        \"उत्कृष्ट\"\n    ];\n    const hindiNegative = [\n        \"बुरा\",\n        \"गंदा\",\n        \"खराब\",\n        \"दुखी\",\n        \"निराश\"\n    ];\n    const words = text.toLowerCase().split(/\\s+/);\n    let positiveCount = 0;\n    let negativeCount = 0;\n    let keywords = [];\n    words.forEach((word)=>{\n        if (positiveWords.includes(word) || hindiPositive.includes(word)) {\n            positiveCount++;\n            keywords.push(word);\n        }\n        if (negativeWords.includes(word) || hindiNegative.includes(word)) {\n            negativeCount++;\n            keywords.push(word);\n        }\n    });\n    let sentiment = \"neutral\";\n    let confidence = 0.5;\n    if (positiveCount > negativeCount) {\n        sentiment = \"positive\";\n        confidence = Math.min(0.9, 0.5 + (positiveCount - negativeCount) * 0.1);\n    } else if (negativeCount > positiveCount) {\n        sentiment = \"negative\";\n        confidence = Math.min(0.9, 0.5 + (negativeCount - positiveCount) * 0.1);\n    }\n    const emotions = {\n        joy: sentiment === \"positive\" ? confidence * 0.8 : 0.1,\n        anger: sentiment === \"negative\" ? confidence * 0.6 : 0.1,\n        sadness: sentiment === \"negative\" ? confidence * 0.4 : 0.1,\n        surprise: 0.2,\n        fear: sentiment === \"negative\" ? confidence * 0.3 : 0.05,\n        disgust: sentiment === \"negative\" ? confidence * 0.2 : 0.05\n    };\n    return {\n        sentiment,\n        confidence,\n        emotions,\n        keywords: keywords.slice(0, 5)\n    };\n}\n// Enhanced feedback database with AI analysis\nlet feedbacks = [\n    {\n        id: 1,\n        userId: \"user_123\",\n        userName: \"Rajesh Kumar\",\n        location: \"Netarhat\",\n        category: \"Homestays\",\n        rating: 5,\n        textFeedback: \"Amazing experience staying with the local family. The food was delicious and the cultural activities were wonderful!\",\n        language: \"en\",\n        aiAnalysis: {\n            sentiment: \"positive\",\n            confidence: 0.9,\n            emotions: {\n                joy: 0.8,\n                satisfaction: 0.7,\n                excitement: 0.6\n            },\n            keywords: [\n                \"amazing\",\n                \"delicious\",\n                \"wonderful\",\n                \"cultural\",\n                \"family\"\n            ],\n            language: \"en\",\n            toxicity: 0.01,\n            urgency: \"low\",\n            categories: [\n                \"accommodation\",\n                \"food\",\n                \"cultural experience\"\n            ],\n            actionableInsights: [\n                \"Leverage positive aspects in marketing and promotion\",\n                \"Highlight cultural activities in homestay descriptions\"\n            ]\n        },\n        timestamp: new Date().toISOString(),\n        isVerified: true,\n        responseFromVendor: undefined,\n        flagged: false,\n        urgencyLevel: \"low\",\n        autoResponseGenerated: \"We're delighted to hear about your positive experience at Netarhat! Thank you for highlighting amazing, delicious, wonderful. We'll share your feedback with our team.\"\n    },\n    {\n        id: 2,\n        userId: \"user_456\",\n        userName: \"Priya Sharma\",\n        location: \"Betla National Park\",\n        category: \"Experiences\",\n        rating: 2,\n        textFeedback: \"The guide was unprofessional and the safari was disappointing. Poor organization overall.\",\n        language: \"en\",\n        aiAnalysis: {\n            sentiment: \"negative\",\n            confidence: 0.8,\n            emotions: {\n                anger: 0.6,\n                disappointment: 0.7,\n                frustration: 0.5\n            },\n            keywords: [\n                \"unprofessional\",\n                \"disappointing\",\n                \"poor\",\n                \"organization\",\n                \"guide\"\n            ],\n            language: \"en\",\n            toxicity: 0.15,\n            urgency: \"high\",\n            categories: [\n                \"service quality\",\n                \"experiences\",\n                \"staff behavior\"\n            ],\n            actionableInsights: [\n                \"Staff training and customer service improvement needed\",\n                \"Review guide certification and training programs\",\n                \"Implement better safari organization protocols\"\n            ]\n        },\n        timestamp: new Date(Date.now() - 86400000).toISOString(),\n        isVerified: true,\n        responseFromVendor: \"We apologize for the poor experience. We have addressed this with our guide team.\",\n        flagged: true,\n        urgencyLevel: \"high\",\n        autoResponseGenerated: \"We sincerely apologize for your experience at Betla National Park. We're taking immediate action on Staff training and customer service improvement needed and Review guide certification and training programs. You can expect an update within 24-48 hours.\",\n        escalated: true\n    }\n];\nasync function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const location = searchParams.get(\"location\");\n        const category = searchParams.get(\"category\");\n        const sentiment = searchParams.get(\"sentiment\");\n        const flagged = searchParams.get(\"flagged\");\n        const urgency = searchParams.get(\"urgency\");\n        const limit = parseInt(searchParams.get(\"limit\") || \"50\");\n        const offset = parseInt(searchParams.get(\"offset\") || \"0\");\n        let filteredFeedbacks = [\n            ...feedbacks\n        ];\n        if (location && location !== \"All\") {\n            filteredFeedbacks = filteredFeedbacks.filter((f)=>f.location === location);\n        }\n        if (category && category !== \"All\") {\n            filteredFeedbacks = filteredFeedbacks.filter((f)=>f.category === category);\n        }\n        if (sentiment && sentiment !== \"All\") {\n            filteredFeedbacks = filteredFeedbacks.filter((f)=>f.aiAnalysis.sentiment === sentiment);\n        }\n        if (flagged === \"true\") {\n            filteredFeedbacks = filteredFeedbacks.filter((f)=>f.flagged);\n        }\n        if (urgency && urgency !== \"All\") {\n            filteredFeedbacks = filteredFeedbacks.filter((f)=>f.urgencyLevel === urgency);\n        }\n        // Sort by timestamp (newest first)\n        filteredFeedbacks.sort((a, b)=>new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime());\n        const paginatedFeedbacks = filteredFeedbacks.slice(offset, offset + limit);\n        // Calculate sentiment statistics\n        const sentimentStats = {\n            positive: filteredFeedbacks.filter((f)=>f.aiAnalysis.sentiment === \"positive\").length,\n            negative: filteredFeedbacks.filter((f)=>f.aiAnalysis.sentiment === \"negative\").length,\n            neutral: filteredFeedbacks.filter((f)=>f.aiAnalysis.sentiment === \"neutral\").length,\n            total: filteredFeedbacks.length\n        };\n        // Calculate urgency statistics\n        const urgencyStats = {\n            critical: filteredFeedbacks.filter((f)=>f.urgencyLevel === \"critical\").length,\n            high: filteredFeedbacks.filter((f)=>f.urgencyLevel === \"high\").length,\n            medium: filteredFeedbacks.filter((f)=>f.urgencyLevel === \"medium\").length,\n            low: filteredFeedbacks.filter((f)=>f.urgencyLevel === \"low\").length\n        };\n        // Get sentiment trends\n        const sentimentTrends = SentimentMonitor.getSentimentTrends(location || undefined, category || undefined);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            feedbacks: paginatedFeedbacks,\n            total: filteredFeedbacks.length,\n            sentimentStats,\n            urgencyStats,\n            sentimentTrends,\n            hasMore: offset + limit < filteredFeedbacks.length\n        });\n    } catch (error) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to fetch feedback\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { userId, userName, location, category, rating, textFeedback, language = \"auto\", voiceData, imageData, emojiRating } = body;\n        // Advanced AI analysis\n        let aiAnalysis;\n        let voiceAnalysis;\n        let imageAnalysis;\n        try {\n            // Convert base64 data to blobs if provided\n            const voiceBlob = voiceData ? new Blob([\n                Buffer.from(voiceData, \"base64\")\n            ], {\n                type: \"audio/wav\"\n            }) : undefined;\n            const imageBlob = imageData ? new Blob([\n                Buffer.from(imageData, \"base64\")\n            ], {\n                type: \"image/jpeg\"\n            }) : undefined;\n            const analysisResults = await analyzeAdvancedFeedback(textFeedback, voiceBlob, imageBlob, language);\n            aiAnalysis = analysisResults.aiAnalysis;\n            voiceAnalysis = analysisResults.voiceAnalysis;\n            imageAnalysis = analysisResults.imageAnalysis;\n        } catch (error) {\n            console.error(\"AI analysis failed, using fallback:\", error);\n            // Fallback to basic analysis\n            aiAnalysis = {\n                sentiment: \"neutral\",\n                confidence: 0.5,\n                emotions: {},\n                keywords: [],\n                language: language || \"en\",\n                toxicity: 0,\n                urgency: \"low\",\n                categories: [],\n                actionableInsights: []\n            };\n        }\n        // Determine urgency level\n        const urgencyLevel = aiAnalysis.urgency || \"low\";\n        // Check for flagging conditions\n        const flagged = aiAnalysis.sentiment === \"negative\" && aiAnalysis.confidence > 0.7 || aiAnalysis.toxicity && aiAnalysis.toxicity > 0.5 || urgencyLevel === \"critical\" || urgencyLevel === \"high\";\n        const newFeedback = {\n            id: feedbacks.length + 1,\n            userId,\n            userName,\n            location,\n            category,\n            rating,\n            textFeedback,\n            language: aiAnalysis.language,\n            voiceData,\n            imageData,\n            emojiRating,\n            aiAnalysis,\n            voiceAnalysis,\n            imageAnalysis,\n            timestamp: new Date().toISOString(),\n            isVerified: false,\n            responseFromVendor: undefined,\n            flagged,\n            urgencyLevel\n        };\n        // Generate auto-response using AI chatbot\n        try {\n            newFeedback.autoResponseGenerated = await FeedbackChatbot.generateResponse(newFeedback);\n        } catch (error) {\n            console.error(\"Auto-response generation failed:\", error);\n        }\n        feedbacks.push(newFeedback);\n        // Add to sentiment monitoring\n        SentimentMonitor.addSentiment(newFeedback);\n        // Trigger alerts for critical issues\n        await AlertSystem.triggerAlert(newFeedback);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            ...newFeedback,\n            followUpQuestions: await FeedbackChatbot.generateFollowUpQuestions(newFeedback)\n        }, {\n            status: 201\n        });\n    } catch (error) {\n        console.error(\"Failed to submit feedback:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to submit feedback\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function PUT(request) {\n    try {\n        const body = await request.json();\n        const { feedbackId, responseFromVendor, flagged } = body;\n        const feedbackIndex = feedbacks.findIndex((f)=>f.id === feedbackId);\n        if (feedbackIndex === -1) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Feedback not found\"\n            }, {\n                status: 404\n            });\n        }\n        feedbacks[feedbackIndex] = {\n            ...feedbacks[feedbackIndex],\n            ...responseFromVendor && {\n                responseFromVendor\n            },\n            ...typeof flagged === \"boolean\" && {\n                flagged\n            },\n            updatedAt: new Date().toISOString()\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(feedbacks[feedbackIndex]);\n    } catch (error) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to update feedback\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TSxFQUFFZ0IsVUFBVSxFQUFFakQsa0JBQWtCLEVBQUVFLE9BQU8sRUFBRSxHQUFHbUM7UUFFcEQsTUFBTWEsZ0JBQWdCN0QsVUFBVThELFNBQVMsQ0FBQ25DLENBQUFBLElBQUtBLEVBQUUxQixFQUFFLEtBQUsyRDtRQUN4RCxJQUFJQyxrQkFBa0IsQ0FBQyxHQUFHO1lBQ3hCLE9BQU81SSxxREFBWUEsQ0FBQzJILElBQUksQ0FBQztnQkFBRXpGLE9BQU87WUFBcUIsR0FBRztnQkFBRTJGLFFBQVE7WUFBSTtRQUMxRTtRQUVBOUMsU0FBUyxDQUFDNkQsY0FBYyxHQUFHO1lBQ3pCLEdBQUc3RCxTQUFTLENBQUM2RCxjQUFjO1lBQzNCLEdBQUlsRCxzQkFBc0I7Z0JBQUVBO1lBQW1CLENBQUM7WUFDaEQsR0FBSSxPQUFPRSxZQUFZLGFBQWE7Z0JBQUVBO1lBQVEsQ0FBQztZQUMvQ2tELFdBQVcsSUFBSXZELE9BQU9DLFdBQVc7UUFDbkM7UUFFQSxPQUFPeEYscURBQVlBLENBQUMySCxJQUFJLENBQUM1QyxTQUFTLENBQUM2RCxjQUFjO0lBQ25ELEVBQUUsT0FBTzFHLE9BQU87UUFDZCxPQUFPbEMscURBQVlBLENBQUMySCxJQUFJLENBQUM7WUFBRXpGLE9BQU87UUFBNEIsR0FBRztZQUFFMkYsUUFBUTtRQUFJO0lBQ2pGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS12MC1wcm9qZWN0Ly4vYXBwL2FwaS9mZWVkYmFjay9yb3V0ZS50cz84MTM3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IGFpU2VydmljZSwgQUlBbmFseXNpc1Jlc3VsdCwgVm9pY2VBbmFseXNpc1Jlc3VsdCwgSW1hZ2VBbmFseXNpc1Jlc3VsdCB9IGZyb20gJ0AvbGliL2FpLXNlcnZpY2VzJ1xuXG4vLyBFbmhhbmNlZCBmZWVkYmFjayBpbnRlcmZhY2VcbmludGVyZmFjZSBFbmhhbmNlZEZlZWRiYWNrIHtcbiAgaWQ6IG51bWJlclxuICB1c2VySWQ6IHN0cmluZ1xuICB1c2VyTmFtZTogc3RyaW5nXG4gIGxvY2F0aW9uOiBzdHJpbmdcbiAgY2F0ZWdvcnk6IHN0cmluZ1xuICByYXRpbmc6IG51bWJlclxuICB0ZXh0RmVlZGJhY2s/OiBzdHJpbmdcbiAgbGFuZ3VhZ2U6IHN0cmluZ1xuICB2b2ljZURhdGE/OiBzdHJpbmdcbiAgaW1hZ2VEYXRhPzogc3RyaW5nXG4gIGVtb2ppUmF0aW5nPzogc3RyaW5nXG4gIGFpQW5hbHlzaXM6IEFJQW5hbHlzaXNSZXN1bHRcbiAgdm9pY2VBbmFseXNpcz86IFZvaWNlQW5hbHlzaXNSZXN1bHRcbiAgaW1hZ2VBbmFseXNpcz86IEltYWdlQW5hbHlzaXNSZXN1bHRcbiAgdGltZXN0YW1wOiBzdHJpbmdcbiAgaXNWZXJpZmllZDogYm9vbGVhblxuICByZXNwb25zZUZyb21WZW5kb3I/OiBzdHJpbmdcbiAgZmxhZ2dlZDogYm9vbGVhblxuICB1cmdlbmN5TGV2ZWw6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcgfCAnY3JpdGljYWwnXG4gIGF1dG9SZXNwb25zZUdlbmVyYXRlZD86IHN0cmluZ1xuICBlc2NhbGF0ZWQ/OiBib29sZWFuXG4gIHJlc29sdmVkQXQ/OiBzdHJpbmdcbiAgc2F0aXNmYWN0aW9uRm9sbG93VXA/OiBudW1iZXJcbn1cblxuLy8gUmVhbC10aW1lIGFsZXJ0IHN5c3RlbVxuY2xhc3MgQWxlcnRTeXN0ZW0ge1xuICBzdGF0aWMgYXN5bmMgdHJpZ2dlckFsZXJ0KGZlZWRiYWNrOiBFbmhhbmNlZEZlZWRiYWNrKSB7XG4gICAgaWYgKGZlZWRiYWNrLnVyZ2VuY3lMZXZlbCA9PT0gJ2NyaXRpY2FsJyB8fCBmZWVkYmFjay51cmdlbmN5TGV2ZWwgPT09ICdoaWdoJykge1xuICAgICAgLy8gSW4gcHJvZHVjdGlvbiwgdGhpcyB3b3VsZCBzZW5kIHJlYWwgbm90aWZpY2F0aW9uc1xuICAgICAgY29uc29sZS5sb2coYPCfmqggQ1JJVElDQUwgQUxFUlQ6ICR7ZmVlZGJhY2subG9jYXRpb259IC0gJHtmZWVkYmFjay5jYXRlZ29yeX1gKTtcbiAgICAgIGNvbnNvbGUubG9nKGBJc3N1ZTogJHtmZWVkYmFjay5haUFuYWx5c2lzLmFjdGlvbmFibGVJbnNpZ2h0cz8uam9pbignLCAnKX1gKTtcbiAgICAgIFxuICAgICAgLy8gQXV0by1nZW5lcmF0ZSByZXNwb25zZSBmb3IgY3JpdGljYWwgaXNzdWVzXG4gICAgICBmZWVkYmFjay5hdXRvUmVzcG9uc2VHZW5lcmF0ZWQgPSBhd2FpdCB0aGlzLmdlbmVyYXRlQXV0b1Jlc3BvbnNlKGZlZWRiYWNrKTtcbiAgICAgIGZlZWRiYWNrLmVzY2FsYXRlZCA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIGFzeW5jIGdlbmVyYXRlQXV0b1Jlc3BvbnNlKGZlZWRiYWNrOiBFbmhhbmNlZEZlZWRiYWNrKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBpbnNpZ2h0cyA9IGZlZWRiYWNrLmFpQW5hbHlzaXMuYWN0aW9uYWJsZUluc2lnaHRzIHx8IFtdO1xuICAgIFxuICAgIGlmIChpbnNpZ2h0cy5zb21lKGkgPT4gaS5pbmNsdWRlcygnVVJHRU5UJykgfHwgaS5pbmNsdWRlcygnU2FmZXR5JykpKSB7XG4gICAgICByZXR1cm4gYFRoYW5rIHlvdSBmb3IgYnJpbmdpbmcgdGhpcyBzYWZldHkgY29uY2VybiB0byBvdXIgYXR0ZW50aW9uLiBXZSBoYXZlIGltbWVkaWF0ZWx5IGVzY2FsYXRlZCB0aGlzIGlzc3VlIHRvIG91ciBzYWZldHkgdGVhbSBhbmQgd2lsbCBhZGRyZXNzIGl0IHdpdGhpbiAyNCBob3Vycy4gWW91ciBzYWZldHkgaXMgb3VyIHRvcCBwcmlvcml0eS5gO1xuICAgIH1cbiAgICBcbiAgICBpZiAoZmVlZGJhY2suYWlBbmFseXNpcy5zZW50aW1lbnQgPT09ICduZWdhdGl2ZScgJiYgZmVlZGJhY2suYWlBbmFseXNpcy5jb25maWRlbmNlID4gMC44KSB7XG4gICAgICByZXR1cm4gYFdlIHNpbmNlcmVseSBhcG9sb2dpemUgZm9yIHlvdXIgZGlzYXBwb2ludGluZyBleHBlcmllbmNlLiBXZSBoYXZlIGZvcndhcmRlZCB5b3VyIGZlZWRiYWNrIHRvIHRoZSByZWxldmFudCB0ZWFtIGZvciBpbW1lZGlhdGUgYWN0aW9uLiBXZSB3aWxsIGNvbnRhY3QgeW91IHdpdGhpbiA0OCBob3VycyB3aXRoIGFuIHVwZGF0ZSBvbiB0aGUgaW1wcm92ZW1lbnRzIGJlaW5nIG1hZGUuYDtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGBUaGFuayB5b3UgZm9yIHlvdXIgdmFsdWFibGUgZmVlZGJhY2suIFdlIGFwcHJlY2lhdGUgeW91IHRha2luZyB0aGUgdGltZSB0byBzaGFyZSB5b3VyIGV4cGVyaWVuY2Ugd2l0aCB1cy5gO1xuICB9XG59XG5cbi8vIEFkdmFuY2VkIEFJLXBvd2VyZWQgZmVlZGJhY2sgYW5hbHlzaXNcbmFzeW5jIGZ1bmN0aW9uIGFuYWx5emVBZHZhbmNlZEZlZWRiYWNrKFxuICB0ZXh0RmVlZGJhY2s/OiBzdHJpbmcsXG4gIHZvaWNlQmxvYj86IEJsb2IsXG4gIGltYWdlQmxvYj86IEJsb2IsXG4gIGxhbmd1YWdlOiBzdHJpbmcgPSAnYXV0bydcbik6IFByb21pc2U8e1xuICBhaUFuYWx5c2lzPzogQUlBbmFseXNpc1Jlc3VsdFxuICB2b2ljZUFuYWx5c2lzPzogVm9pY2VBbmFseXNpc1Jlc3VsdFxuICBpbWFnZUFuYWx5c2lzPzogSW1hZ2VBbmFseXNpc1Jlc3VsdFxufT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdHM6IGFueSA9IHt9XG5cbiAgICAvLyBBbmFseXplIHRleHQgaWYgcHJvdmlkZWRcbiAgICBpZiAodGV4dEZlZWRiYWNrKSB7XG4gICAgICByZXN1bHRzLmFpQW5hbHlzaXMgPSBhd2FpdCBhaVNlcnZpY2UuYW5hbHl6ZVRleHQodGV4dEZlZWRiYWNrLCBsYW5ndWFnZSlcbiAgICB9XG5cbiAgICAvLyBBbmFseXplIHZvaWNlIGlmIHByb3ZpZGVkXG4gICAgaWYgKHZvaWNlQmxvYikge1xuICAgICAgcmVzdWx0cy52b2ljZUFuYWx5c2lzID0gYXdhaXQgYWlTZXJ2aWNlLmFuYWx5emVWb2ljZSh2b2ljZUJsb2IpXG4gICAgICBcbiAgICAgIC8vIElmIG5vIHRleHQgZmVlZGJhY2ssIHVzZSB2b2ljZSB0cmFuc2NyaXB0aW9uIGZvciB0ZXh0IGFuYWx5c2lzXG4gICAgICBpZiAoIXRleHRGZWVkYmFjayAmJiByZXN1bHRzLnZvaWNlQW5hbHlzaXMudHJhbnNjcmlwdGlvbikge1xuICAgICAgICByZXN1bHRzLmFpQW5hbHlzaXMgPSBhd2FpdCBhaVNlcnZpY2UuYW5hbHl6ZVRleHQocmVzdWx0cy52b2ljZUFuYWx5c2lzLnRyYW5zY3JpcHRpb24sIGxhbmd1YWdlKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFuYWx5emUgaW1hZ2UgaWYgcHJvdmlkZWRcbiAgICBpZiAoaW1hZ2VCbG9iKSB7XG4gICAgICByZXN1bHRzLmltYWdlQW5hbHlzaXMgPSBhd2FpdCBhaVNlcnZpY2UuYW5hbHl6ZUltYWdlKGltYWdlQmxvYilcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0c1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FkdmFuY2VkIGZlZWRiYWNrIGFuYWx5c2lzIGZhaWxlZDonLCBlcnJvcilcbiAgICBcbiAgICAvLyBGYWxsYmFjayBhbmFseXNpc1xuICAgIGlmICh0ZXh0RmVlZGJhY2spIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFpQW5hbHlzaXM6IGF3YWl0IGFpU2VydmljZS5hbmFseXplVGV4dCh0ZXh0RmVlZGJhY2ssIGxhbmd1YWdlKVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG5cbi8vIFJlYWwtdGltZSBzZW50aW1lbnQgbW9uaXRvcmluZ1xuY2xhc3MgU2VudGltZW50TW9uaXRvciB7XG4gIHByaXZhdGUgc3RhdGljIHNlbnRpbWVudEhpc3Rvcnk6IEFycmF5PHtcbiAgICB0aW1lc3RhbXA6IHN0cmluZ1xuICAgIHNlbnRpbWVudDogc3RyaW5nXG4gICAgY29uZmlkZW5jZTogbnVtYmVyXG4gICAgbG9jYXRpb246IHN0cmluZ1xuICAgIGNhdGVnb3J5OiBzdHJpbmdcbiAgfT4gPSBbXVxuXG4gIHN0YXRpYyBhZGRTZW50aW1lbnQoZmVlZGJhY2s6IEVuaGFuY2VkRmVlZGJhY2spIHtcbiAgICB0aGlzLnNlbnRpbWVudEhpc3RvcnkucHVzaCh7XG4gICAgICB0aW1lc3RhbXA6IGZlZWRiYWNrLnRpbWVzdGFtcCxcbiAgICAgIHNlbnRpbWVudDogZmVlZGJhY2suYWlBbmFseXNpcy5zZW50aW1lbnQsXG4gICAgICBjb25maWRlbmNlOiBmZWVkYmFjay5haUFuYWx5c2lzLmNvbmZpZGVuY2UsXG4gICAgICBsb2NhdGlvbjogZmVlZGJhY2subG9jYXRpb24sXG4gICAgICBjYXRlZ29yeTogZmVlZGJhY2suY2F0ZWdvcnlcbiAgICB9KVxuXG4gICAgLy8gS2VlcCBvbmx5IGxhc3QgMTAwMCBlbnRyaWVzXG4gICAgaWYgKHRoaXMuc2VudGltZW50SGlzdG9yeS5sZW5ndGggPiAxMDAwKSB7XG4gICAgICB0aGlzLnNlbnRpbWVudEhpc3RvcnkgPSB0aGlzLnNlbnRpbWVudEhpc3Rvcnkuc2xpY2UoLTEwMDApXG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgZm9yIHNlbnRpbWVudCB0cmVuZHNcbiAgICB0aGlzLmNoZWNrU2VudGltZW50VHJlbmRzKGZlZWRiYWNrLmxvY2F0aW9uLCBmZWVkYmFjay5jYXRlZ29yeSlcbiAgfVxuXG4gIHN0YXRpYyBjaGVja1NlbnRpbWVudFRyZW5kcyhsb2NhdGlvbjogc3RyaW5nLCBjYXRlZ29yeTogc3RyaW5nKSB7XG4gICAgY29uc3QgcmVjZW50RmVlZGJhY2tzID0gdGhpcy5zZW50aW1lbnRIaXN0b3J5XG4gICAgICAuZmlsdGVyKHMgPT4gcy5sb2NhdGlvbiA9PT0gbG9jYXRpb24gJiYgcy5jYXRlZ29yeSA9PT0gY2F0ZWdvcnkpXG4gICAgICAuc2xpY2UoLTEwKSAvLyBMYXN0IDEwIGZlZWRiYWNrcyBmb3IgdGhpcyBsb2NhdGlvbi9jYXRlZ29yeVxuXG4gICAgaWYgKHJlY2VudEZlZWRiYWNrcy5sZW5ndGggPj0gNSkge1xuICAgICAgY29uc3QgbmVnYXRpdmVGZWVkYmFja3MgPSByZWNlbnRGZWVkYmFja3MuZmlsdGVyKHMgPT4gcy5zZW50aW1lbnQgPT09ICduZWdhdGl2ZScpXG4gICAgICBcbiAgICAgIGlmIChuZWdhdGl2ZUZlZWRiYWNrcy5sZW5ndGggPj0gMykge1xuICAgICAgICBjb25zb2xlLmxvZyhg4pqg77iPIFRSRU5EIEFMRVJUOiBJbmNyZWFzaW5nIG5lZ2F0aXZlIHNlbnRpbWVudCBkZXRlY3RlZCBmb3IgJHtsb2NhdGlvbn0gLSAke2NhdGVnb3J5fWApXG4gICAgICAgIC8vIEluIHByb2R1Y3Rpb24sIHRoaXMgd291bGQgdHJpZ2dlciBub3RpZmljYXRpb25zIHRvIHRvdXJpc20gb2ZmaWNpYWxzXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgc3RhdGljIGdldFNlbnRpbWVudFRyZW5kcyhsb2NhdGlvbj86IHN0cmluZywgY2F0ZWdvcnk/OiBzdHJpbmcpIHtcbiAgICBsZXQgZmlsdGVyZWQgPSB0aGlzLnNlbnRpbWVudEhpc3RvcnlcbiAgICBcbiAgICBpZiAobG9jYXRpb24pIHtcbiAgICAgIGZpbHRlcmVkID0gZmlsdGVyZWQuZmlsdGVyKHMgPT4gcy5sb2NhdGlvbiA9PT0gbG9jYXRpb24pXG4gICAgfVxuICAgIFxuICAgIGlmIChjYXRlZ29yeSkge1xuICAgICAgZmlsdGVyZWQgPSBmaWx0ZXJlZC5maWx0ZXIocyA9PiBzLmNhdGVnb3J5ID09PSBjYXRlZ29yeSlcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGZpbHRlcmVkLnNsaWNlKC0zMCkgLy8gTGFzdCAzMCBlbnRyaWVzXG4gIH1cbn1cblxuLy8gQUktcG93ZXJlZCBjaGF0Ym90IGZvciBpbnN0YW50IHJlc3BvbnNlc1xuY2xhc3MgRmVlZGJhY2tDaGF0Ym90IHtcbiAgc3RhdGljIGFzeW5jIGdlbmVyYXRlUmVzcG9uc2UoZmVlZGJhY2s6IEVuaGFuY2VkRmVlZGJhY2spOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHsgYWlBbmFseXNpcywgbG9jYXRpb24sIGNhdGVnb3J5IH0gPSBmZWVkYmFja1xuICAgIFxuICAgIC8vIEdlbmVyYXRlIGNvbnRleHR1YWwgcmVzcG9uc2UgYmFzZWQgb24gQUkgYW5hbHlzaXNcbiAgICBpZiAoYWlBbmFseXNpcy51cmdlbmN5ID09PSAnY3JpdGljYWwnKSB7XG4gICAgICByZXR1cm4gYFRoYW5rIHlvdSBmb3IgdGhpcyBjcml0aWNhbCBmZWVkYmFjayBhYm91dCAke2xvY2F0aW9ufS4gV2UgYXJlIGltbWVkaWF0ZWx5IGFkZHJlc3NpbmcgdGhlICR7YWlBbmFseXNpcy5jYXRlZ29yaWVzPy5qb2luKCcsICcpfSBpc3N1ZXMgeW91J3ZlIG1lbnRpb25lZC4gQSBzZW5pb3Igb2ZmaWNpYWwgd2lsbCBjb250YWN0IHlvdSB3aXRoaW4gMiBob3Vycy5gXG4gICAgfVxuICAgIFxuICAgIGlmIChhaUFuYWx5c2lzLnNlbnRpbWVudCA9PT0gJ3Bvc2l0aXZlJykge1xuICAgICAgcmV0dXJuIGBXZSdyZSBkZWxpZ2h0ZWQgdG8gaGVhciBhYm91dCB5b3VyIHBvc2l0aXZlIGV4cGVyaWVuY2UgYXQgJHtsb2NhdGlvbn0hIFRoYW5rIHlvdSBmb3IgaGlnaGxpZ2h0aW5nICR7YWlBbmFseXNpcy5rZXl3b3Jkcy5zbGljZSgwLCAzKS5qb2luKCcsICcpfS4gV2UnbGwgc2hhcmUgeW91ciBmZWVkYmFjayB3aXRoIG91ciB0ZWFtLmBcbiAgICB9XG4gICAgXG4gICAgaWYgKGFpQW5hbHlzaXMuc2VudGltZW50ID09PSAnbmVnYXRpdmUnKSB7XG4gICAgICBjb25zdCBpc3N1ZXMgPSBhaUFuYWx5c2lzLmFjdGlvbmFibGVJbnNpZ2h0cz8uc2xpY2UoMCwgMikuam9pbignIGFuZCAnKSB8fCAndGhlIGlzc3VlcyB5b3UgbWVudGlvbmVkJ1xuICAgICAgcmV0dXJuIGBXZSBzaW5jZXJlbHkgYXBvbG9naXplIGZvciB5b3VyIGV4cGVyaWVuY2UgYXQgJHtsb2NhdGlvbn0uIFdlJ3JlIHRha2luZyBpbW1lZGlhdGUgYWN0aW9uIG9uICR7aXNzdWVzfS4gWW91IGNhbiBleHBlY3QgYW4gdXBkYXRlIHdpdGhpbiAyNC00OCBob3Vycy5gXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBgVGhhbmsgeW91IGZvciB5b3VyIGZlZWRiYWNrIGFib3V0ICR7bG9jYXRpb259LiBZb3VyIGluc2lnaHRzIGFib3V0ICR7Y2F0ZWdvcnkudG9Mb3dlckNhc2UoKX0gYXJlIHZhbHVhYmxlIGZvciBpbXByb3Zpbmcgb3VyIHRvdXJpc20gc2VydmljZXMuYFxuICB9XG4gIFxuICBzdGF0aWMgYXN5bmMgZ2VuZXJhdGVGb2xsb3dVcFF1ZXN0aW9ucyhmZWVkYmFjazogRW5oYW5jZWRGZWVkYmFjayk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBjb25zdCBxdWVzdGlvbnM6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICBpZiAoZmVlZGJhY2suYWlBbmFseXNpcy5zZW50aW1lbnQgPT09ICduZWdhdGl2ZScpIHtcbiAgICAgIHF1ZXN0aW9ucy5wdXNoKCdXaGF0IHNwZWNpZmljIHN0ZXBzIHdvdWxkIHlvdSBsaWtlIHRvIHNlZSBpbXBsZW1lbnRlZCB0byBpbXByb3ZlIHRoaXMgZXhwZXJpZW5jZT8nKVxuICAgICAgcXVlc3Rpb25zLnB1c2goJ1dvdWxkIHlvdSBiZSB3aWxsaW5nIHRvIHJldmlzaXQgdGhpcyBsb2NhdGlvbiBpZiBpbXByb3ZlbWVudHMgd2VyZSBtYWRlPycpXG4gICAgfVxuICAgIFxuICAgIGlmIChmZWVkYmFjay5haUFuYWx5c2lzLmNhdGVnb3JpZXM/LmluY2x1ZGVzKCdzZXJ2aWNlIHF1YWxpdHknKSkge1xuICAgICAgcXVlc3Rpb25zLnB1c2goJ0NhbiB5b3UgcHJvdmlkZSBtb3JlIGRldGFpbHMgYWJvdXQgdGhlIHN0YWZmIGludGVyYWN0aW9uPycpXG4gICAgfVxuICAgIFxuICAgIGlmIChmZWVkYmFjay5haUFuYWx5c2lzLmNhdGVnb3JpZXM/LmluY2x1ZGVzKCdjbGVhbmxpbmVzcycpKSB7XG4gICAgICBxdWVzdGlvbnMucHVzaCgnV2hpY2ggc3BlY2lmaWMgYXJlYXMgbmVlZCBhdHRlbnRpb24gcmVnYXJkaW5nIGNsZWFubGluZXNzPycpXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBxdWVzdGlvbnMuc2xpY2UoMCwgMylcbiAgfVxufVxuXG4vLyBGYWxsYmFjayBydWxlLWJhc2VkIHNlbnRpbWVudCBhbmFseXNpc1xuZnVuY3Rpb24gZmFsbGJhY2tTZW50aW1lbnRBbmFseXNpcyh0ZXh0OiBzdHJpbmcsIGxhbmd1YWdlOiBzdHJpbmcpOiB7XG4gIHNlbnRpbWVudDogJ3Bvc2l0aXZlJyB8ICduZWdhdGl2ZScgfCAnbmV1dHJhbCdcbiAgY29uZmlkZW5jZTogbnVtYmVyXG4gIGVtb3Rpb25zOiB7IFtrZXk6IHN0cmluZ106IG51bWJlciB9XG4gIGtleXdvcmRzOiBzdHJpbmdbXVxufSB7XG4gIGNvbnN0IHBvc2l0aXZlV29yZHMgPSBbJ2dvb2QnLCAnZ3JlYXQnLCAnZXhjZWxsZW50JywgJ2FtYXppbmcnLCAnd29uZGVyZnVsJywgJ2JlYXV0aWZ1bCcsICdsb3ZlJywgJ3BlcmZlY3QnLCAnYXdlc29tZScsICdmYW50YXN0aWMnXVxuICBjb25zdCBuZWdhdGl2ZVdvcmRzID0gWydiYWQnLCAndGVycmlibGUnLCAnYXdmdWwnLCAnaG9ycmlibGUnLCAnaGF0ZScsICd3b3JzdCcsICdkaXNhcHBvaW50aW5nJywgJ3Bvb3InLCAnZGlydHknLCAndW5zYWZlJ11cbiAgXG4gIC8vIEhpbmRpIHBvc2l0aXZlL25lZ2F0aXZlIHdvcmRzXG4gIGNvbnN0IGhpbmRpUG9zaXRpdmUgPSBbJ+CkheCkmuCljeCkm+CkvicsICfgpKzgpLngpYHgpKQnLCAn4KS44KWB4KSC4KSm4KSwJywgJ+CkluClgeCkticsICfgpKrgpY3gpLDgpLjgpKjgpY3gpKgnLCAn4KSJ4KSk4KWN4KSV4KWD4KS34KWN4KSfJ11cbiAgY29uc3QgaGluZGlOZWdhdGl2ZSA9IFsn4KSs4KWB4KSw4KS+JywgJ+Ckl+CkguCkpuCkvicsICfgpJbgpLDgpL7gpKwnLCAn4KSm4KWB4KSW4KWAJywgJ+CkqOCkv+CksOCkvuCktiddXG5cbiAgY29uc3Qgd29yZHMgPSB0ZXh0LnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xccysvKVxuICBsZXQgcG9zaXRpdmVDb3VudCA9IDBcbiAgbGV0IG5lZ2F0aXZlQ291bnQgPSAwXG4gIGxldCBrZXl3b3Jkczogc3RyaW5nW10gPSBbXVxuXG4gIHdvcmRzLmZvckVhY2god29yZCA9PiB7XG4gICAgaWYgKHBvc2l0aXZlV29yZHMuaW5jbHVkZXMod29yZCkgfHwgaGluZGlQb3NpdGl2ZS5pbmNsdWRlcyh3b3JkKSkge1xuICAgICAgcG9zaXRpdmVDb3VudCsrXG4gICAgICBrZXl3b3Jkcy5wdXNoKHdvcmQpXG4gICAgfVxuICAgIGlmIChuZWdhdGl2ZVdvcmRzLmluY2x1ZGVzKHdvcmQpIHx8IGhpbmRpTmVnYXRpdmUuaW5jbHVkZXMod29yZCkpIHtcbiAgICAgIG5lZ2F0aXZlQ291bnQrK1xuICAgICAga2V5d29yZHMucHVzaCh3b3JkKVxuICAgIH1cbiAgfSlcblxuICBsZXQgc2VudGltZW50OiAncG9zaXRpdmUnIHwgJ25lZ2F0aXZlJyB8ICduZXV0cmFsJyA9ICduZXV0cmFsJ1xuICBsZXQgY29uZmlkZW5jZSA9IDAuNVxuXG4gIGlmIChwb3NpdGl2ZUNvdW50ID4gbmVnYXRpdmVDb3VudCkge1xuICAgIHNlbnRpbWVudCA9ICdwb3NpdGl2ZSdcbiAgICBjb25maWRlbmNlID0gTWF0aC5taW4oMC45LCAwLjUgKyAocG9zaXRpdmVDb3VudCAtIG5lZ2F0aXZlQ291bnQpICogMC4xKVxuICB9IGVsc2UgaWYgKG5lZ2F0aXZlQ291bnQgPiBwb3NpdGl2ZUNvdW50KSB7XG4gICAgc2VudGltZW50ID0gJ25lZ2F0aXZlJ1xuICAgIGNvbmZpZGVuY2UgPSBNYXRoLm1pbigwLjksIDAuNSArIChuZWdhdGl2ZUNvdW50IC0gcG9zaXRpdmVDb3VudCkgKiAwLjEpXG4gIH1cblxuICBjb25zdCBlbW90aW9ucyA9IHtcbiAgICBqb3k6IHNlbnRpbWVudCA9PT0gJ3Bvc2l0aXZlJyA/IGNvbmZpZGVuY2UgKiAwLjggOiAwLjEsXG4gICAgYW5nZXI6IHNlbnRpbWVudCA9PT0gJ25lZ2F0aXZlJyA/IGNvbmZpZGVuY2UgKiAwLjYgOiAwLjEsXG4gICAgc2FkbmVzczogc2VudGltZW50ID09PSAnbmVnYXRpdmUnID8gY29uZmlkZW5jZSAqIDAuNCA6IDAuMSxcbiAgICBzdXJwcmlzZTogMC4yLFxuICAgIGZlYXI6IHNlbnRpbWVudCA9PT0gJ25lZ2F0aXZlJyA/IGNvbmZpZGVuY2UgKiAwLjMgOiAwLjA1LFxuICAgIGRpc2d1c3Q6IHNlbnRpbWVudCA9PT0gJ25lZ2F0aXZlJyA/IGNvbmZpZGVuY2UgKiAwLjIgOiAwLjA1XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHNlbnRpbWVudCxcbiAgICBjb25maWRlbmNlLFxuICAgIGVtb3Rpb25zLFxuICAgIGtleXdvcmRzOiBrZXl3b3Jkcy5zbGljZSgwLCA1KVxuICB9XG59XG5cbi8vIEVuaGFuY2VkIGZlZWRiYWNrIGRhdGFiYXNlIHdpdGggQUkgYW5hbHlzaXNcbmxldCBmZWVkYmFja3M6IEVuaGFuY2VkRmVlZGJhY2tbXSA9IFtcbiAge1xuICAgIGlkOiAxLFxuICAgIHVzZXJJZDogXCJ1c2VyXzEyM1wiLFxuICAgIHVzZXJOYW1lOiBcIlJhamVzaCBLdW1hclwiLFxuICAgIGxvY2F0aW9uOiBcIk5ldGFyaGF0XCIsXG4gICAgY2F0ZWdvcnk6IFwiSG9tZXN0YXlzXCIsXG4gICAgcmF0aW5nOiA1LFxuICAgIHRleHRGZWVkYmFjazogXCJBbWF6aW5nIGV4cGVyaWVuY2Ugc3RheWluZyB3aXRoIHRoZSBsb2NhbCBmYW1pbHkuIFRoZSBmb29kIHdhcyBkZWxpY2lvdXMgYW5kIHRoZSBjdWx0dXJhbCBhY3Rpdml0aWVzIHdlcmUgd29uZGVyZnVsIVwiLFxuICAgIGxhbmd1YWdlOiBcImVuXCIsXG4gICAgYWlBbmFseXNpczoge1xuICAgICAgc2VudGltZW50OiBcInBvc2l0aXZlXCIsXG4gICAgICBjb25maWRlbmNlOiAwLjksXG4gICAgICBlbW90aW9uczogeyBqb3k6IDAuOCwgc2F0aXNmYWN0aW9uOiAwLjcsIGV4Y2l0ZW1lbnQ6IDAuNiB9LFxuICAgICAga2V5d29yZHM6IFtcImFtYXppbmdcIiwgXCJkZWxpY2lvdXNcIiwgXCJ3b25kZXJmdWxcIiwgXCJjdWx0dXJhbFwiLCBcImZhbWlseVwiXSxcbiAgICAgIGxhbmd1YWdlOiBcImVuXCIsXG4gICAgICB0b3hpY2l0eTogMC4wMSxcbiAgICAgIHVyZ2VuY3k6IFwibG93XCIsXG4gICAgICBjYXRlZ29yaWVzOiBbXCJhY2NvbW1vZGF0aW9uXCIsIFwiZm9vZFwiLCBcImN1bHR1cmFsIGV4cGVyaWVuY2VcIl0sXG4gICAgICBhY3Rpb25hYmxlSW5zaWdodHM6IFtcIkxldmVyYWdlIHBvc2l0aXZlIGFzcGVjdHMgaW4gbWFya2V0aW5nIGFuZCBwcm9tb3Rpb25cIiwgXCJIaWdobGlnaHQgY3VsdHVyYWwgYWN0aXZpdGllcyBpbiBob21lc3RheSBkZXNjcmlwdGlvbnNcIl1cbiAgICB9LFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIGlzVmVyaWZpZWQ6IHRydWUsXG4gICAgcmVzcG9uc2VGcm9tVmVuZG9yOiB1bmRlZmluZWQsXG4gICAgZmxhZ2dlZDogZmFsc2UsXG4gICAgdXJnZW5jeUxldmVsOiBcImxvd1wiLFxuICAgIGF1dG9SZXNwb25zZUdlbmVyYXRlZDogXCJXZSdyZSBkZWxpZ2h0ZWQgdG8gaGVhciBhYm91dCB5b3VyIHBvc2l0aXZlIGV4cGVyaWVuY2UgYXQgTmV0YXJoYXQhIFRoYW5rIHlvdSBmb3IgaGlnaGxpZ2h0aW5nIGFtYXppbmcsIGRlbGljaW91cywgd29uZGVyZnVsLiBXZSdsbCBzaGFyZSB5b3VyIGZlZWRiYWNrIHdpdGggb3VyIHRlYW0uXCJcbiAgfSxcbiAge1xuICAgIGlkOiAyLFxuICAgIHVzZXJJZDogXCJ1c2VyXzQ1NlwiLFxuICAgIHVzZXJOYW1lOiBcIlByaXlhIFNoYXJtYVwiLFxuICAgIGxvY2F0aW9uOiBcIkJldGxhIE5hdGlvbmFsIFBhcmtcIixcbiAgICBjYXRlZ29yeTogXCJFeHBlcmllbmNlc1wiLFxuICAgIHJhdGluZzogMixcbiAgICB0ZXh0RmVlZGJhY2s6IFwiVGhlIGd1aWRlIHdhcyB1bnByb2Zlc3Npb25hbCBhbmQgdGhlIHNhZmFyaSB3YXMgZGlzYXBwb2ludGluZy4gUG9vciBvcmdhbml6YXRpb24gb3ZlcmFsbC5cIixcbiAgICBsYW5ndWFnZTogXCJlblwiLFxuICAgIGFpQW5hbHlzaXM6IHtcbiAgICAgIHNlbnRpbWVudDogXCJuZWdhdGl2ZVwiLFxuICAgICAgY29uZmlkZW5jZTogMC44LFxuICAgICAgZW1vdGlvbnM6IHsgYW5nZXI6IDAuNiwgZGlzYXBwb2ludG1lbnQ6IDAuNywgZnJ1c3RyYXRpb246IDAuNSB9LFxuICAgICAga2V5d29yZHM6IFtcInVucHJvZmVzc2lvbmFsXCIsIFwiZGlzYXBwb2ludGluZ1wiLCBcInBvb3JcIiwgXCJvcmdhbml6YXRpb25cIiwgXCJndWlkZVwiXSxcbiAgICAgIGxhbmd1YWdlOiBcImVuXCIsXG4gICAgICB0b3hpY2l0eTogMC4xNSxcbiAgICAgIHVyZ2VuY3k6IFwiaGlnaFwiLFxuICAgICAgY2F0ZWdvcmllczogW1wic2VydmljZSBxdWFsaXR5XCIsIFwiZXhwZXJpZW5jZXNcIiwgXCJzdGFmZiBiZWhhdmlvclwiXSxcbiAgICAgIGFjdGlvbmFibGVJbnNpZ2h0czogW1wiU3RhZmYgdHJhaW5pbmcgYW5kIGN1c3RvbWVyIHNlcnZpY2UgaW1wcm92ZW1lbnQgbmVlZGVkXCIsIFwiUmV2aWV3IGd1aWRlIGNlcnRpZmljYXRpb24gYW5kIHRyYWluaW5nIHByb2dyYW1zXCIsIFwiSW1wbGVtZW50IGJldHRlciBzYWZhcmkgb3JnYW5pemF0aW9uIHByb3RvY29sc1wiXVxuICAgIH0sXG4gICAgdGltZXN0YW1wOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gODY0MDAwMDApLnRvSVNPU3RyaW5nKCksXG4gICAgaXNWZXJpZmllZDogdHJ1ZSxcbiAgICByZXNwb25zZUZyb21WZW5kb3I6IFwiV2UgYXBvbG9naXplIGZvciB0aGUgcG9vciBleHBlcmllbmNlLiBXZSBoYXZlIGFkZHJlc3NlZCB0aGlzIHdpdGggb3VyIGd1aWRlIHRlYW0uXCIsXG4gICAgZmxhZ2dlZDogdHJ1ZSxcbiAgICB1cmdlbmN5TGV2ZWw6IFwiaGlnaFwiLFxuICAgIGF1dG9SZXNwb25zZUdlbmVyYXRlZDogXCJXZSBzaW5jZXJlbHkgYXBvbG9naXplIGZvciB5b3VyIGV4cGVyaWVuY2UgYXQgQmV0bGEgTmF0aW9uYWwgUGFyay4gV2UncmUgdGFraW5nIGltbWVkaWF0ZSBhY3Rpb24gb24gU3RhZmYgdHJhaW5pbmcgYW5kIGN1c3RvbWVyIHNlcnZpY2UgaW1wcm92ZW1lbnQgbmVlZGVkIGFuZCBSZXZpZXcgZ3VpZGUgY2VydGlmaWNhdGlvbiBhbmQgdHJhaW5pbmcgcHJvZ3JhbXMuIFlvdSBjYW4gZXhwZWN0IGFuIHVwZGF0ZSB3aXRoaW4gMjQtNDggaG91cnMuXCIsXG4gICAgZXNjYWxhdGVkOiB0cnVlXG4gIH1cbl1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcXVlc3QudXJsKVxuICAgIGNvbnN0IGxvY2F0aW9uID0gc2VhcmNoUGFyYW1zLmdldCgnbG9jYXRpb24nKVxuICAgIGNvbnN0IGNhdGVnb3J5ID0gc2VhcmNoUGFyYW1zLmdldCgnY2F0ZWdvcnknKVxuICAgIGNvbnN0IHNlbnRpbWVudCA9IHNlYXJjaFBhcmFtcy5nZXQoJ3NlbnRpbWVudCcpXG4gICAgY29uc3QgZmxhZ2dlZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ2ZsYWdnZWQnKVxuICAgIGNvbnN0IHVyZ2VuY3kgPSBzZWFyY2hQYXJhbXMuZ2V0KCd1cmdlbmN5JylcbiAgICBjb25zdCBsaW1pdCA9IHBhcnNlSW50KHNlYXJjaFBhcmFtcy5nZXQoJ2xpbWl0JykgfHwgJzUwJylcbiAgICBjb25zdCBvZmZzZXQgPSBwYXJzZUludChzZWFyY2hQYXJhbXMuZ2V0KCdvZmZzZXQnKSB8fCAnMCcpXG5cbiAgICBsZXQgZmlsdGVyZWRGZWVkYmFja3MgPSBbLi4uZmVlZGJhY2tzXVxuXG4gICAgaWYgKGxvY2F0aW9uICYmIGxvY2F0aW9uICE9PSAnQWxsJykge1xuICAgICAgZmlsdGVyZWRGZWVkYmFja3MgPSBmaWx0ZXJlZEZlZWRiYWNrcy5maWx0ZXIoZiA9PiBmLmxvY2F0aW9uID09PSBsb2NhdGlvbilcbiAgICB9XG5cbiAgICBpZiAoY2F0ZWdvcnkgJiYgY2F0ZWdvcnkgIT09ICdBbGwnKSB7XG4gICAgICBmaWx0ZXJlZEZlZWRiYWNrcyA9IGZpbHRlcmVkRmVlZGJhY2tzLmZpbHRlcihmID0+IGYuY2F0ZWdvcnkgPT09IGNhdGVnb3J5KVxuICAgIH1cblxuICAgIGlmIChzZW50aW1lbnQgJiYgc2VudGltZW50ICE9PSAnQWxsJykge1xuICAgICAgZmlsdGVyZWRGZWVkYmFja3MgPSBmaWx0ZXJlZEZlZWRiYWNrcy5maWx0ZXIoZiA9PiBmLmFpQW5hbHlzaXMuc2VudGltZW50ID09PSBzZW50aW1lbnQpXG4gICAgfVxuXG4gICAgaWYgKGZsYWdnZWQgPT09ICd0cnVlJykge1xuICAgICAgZmlsdGVyZWRGZWVkYmFja3MgPSBmaWx0ZXJlZEZlZWRiYWNrcy5maWx0ZXIoZiA9PiBmLmZsYWdnZWQpXG4gICAgfVxuXG4gICAgaWYgKHVyZ2VuY3kgJiYgdXJnZW5jeSAhPT0gJ0FsbCcpIHtcbiAgICAgIGZpbHRlcmVkRmVlZGJhY2tzID0gZmlsdGVyZWRGZWVkYmFja3MuZmlsdGVyKGYgPT4gZi51cmdlbmN5TGV2ZWwgPT09IHVyZ2VuY3kpXG4gICAgfVxuXG4gICAgLy8gU29ydCBieSB0aW1lc3RhbXAgKG5ld2VzdCBmaXJzdClcbiAgICBmaWx0ZXJlZEZlZWRiYWNrcy5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShiLnRpbWVzdGFtcCkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYS50aW1lc3RhbXApLmdldFRpbWUoKSlcblxuICAgIGNvbnN0IHBhZ2luYXRlZEZlZWRiYWNrcyA9IGZpbHRlcmVkRmVlZGJhY2tzLnNsaWNlKG9mZnNldCwgb2Zmc2V0ICsgbGltaXQpXG5cbiAgICAvLyBDYWxjdWxhdGUgc2VudGltZW50IHN0YXRpc3RpY3NcbiAgICBjb25zdCBzZW50aW1lbnRTdGF0cyA9IHtcbiAgICAgIHBvc2l0aXZlOiBmaWx0ZXJlZEZlZWRiYWNrcy5maWx0ZXIoZiA9PiBmLmFpQW5hbHlzaXMuc2VudGltZW50ID09PSAncG9zaXRpdmUnKS5sZW5ndGgsXG4gICAgICBuZWdhdGl2ZTogZmlsdGVyZWRGZWVkYmFja3MuZmlsdGVyKGYgPT4gZi5haUFuYWx5c2lzLnNlbnRpbWVudCA9PT0gJ25lZ2F0aXZlJykubGVuZ3RoLFxuICAgICAgbmV1dHJhbDogZmlsdGVyZWRGZWVkYmFja3MuZmlsdGVyKGYgPT4gZi5haUFuYWx5c2lzLnNlbnRpbWVudCA9PT0gJ25ldXRyYWwnKS5sZW5ndGgsXG4gICAgICB0b3RhbDogZmlsdGVyZWRGZWVkYmFja3MubGVuZ3RoXG4gICAgfVxuXG4gICAgLy8gQ2FsY3VsYXRlIHVyZ2VuY3kgc3RhdGlzdGljc1xuICAgIGNvbnN0IHVyZ2VuY3lTdGF0cyA9IHtcbiAgICAgIGNyaXRpY2FsOiBmaWx0ZXJlZEZlZWRiYWNrcy5maWx0ZXIoZiA9PiBmLnVyZ2VuY3lMZXZlbCA9PT0gJ2NyaXRpY2FsJykubGVuZ3RoLFxuICAgICAgaGlnaDogZmlsdGVyZWRGZWVkYmFja3MuZmlsdGVyKGYgPT4gZi51cmdlbmN5TGV2ZWwgPT09ICdoaWdoJykubGVuZ3RoLFxuICAgICAgbWVkaXVtOiBmaWx0ZXJlZEZlZWRiYWNrcy5maWx0ZXIoZiA9PiBmLnVyZ2VuY3lMZXZlbCA9PT0gJ21lZGl1bScpLmxlbmd0aCxcbiAgICAgIGxvdzogZmlsdGVyZWRGZWVkYmFja3MuZmlsdGVyKGYgPT4gZi51cmdlbmN5TGV2ZWwgPT09ICdsb3cnKS5sZW5ndGhcbiAgICB9XG5cbiAgICAvLyBHZXQgc2VudGltZW50IHRyZW5kc1xuICAgIGNvbnN0IHNlbnRpbWVudFRyZW5kcyA9IFNlbnRpbWVudE1vbml0b3IuZ2V0U2VudGltZW50VHJlbmRzKGxvY2F0aW9uIHx8IHVuZGVmaW5lZCwgY2F0ZWdvcnkgfHwgdW5kZWZpbmVkKVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIGZlZWRiYWNrczogcGFnaW5hdGVkRmVlZGJhY2tzLFxuICAgICAgdG90YWw6IGZpbHRlcmVkRmVlZGJhY2tzLmxlbmd0aCxcbiAgICAgIHNlbnRpbWVudFN0YXRzLFxuICAgICAgdXJnZW5jeVN0YXRzLFxuICAgICAgc2VudGltZW50VHJlbmRzLFxuICAgICAgaGFzTW9yZTogb2Zmc2V0ICsgbGltaXQgPCBmaWx0ZXJlZEZlZWRiYWNrcy5sZW5ndGhcbiAgICB9KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIGZlZWRiYWNrJyB9LCB7IHN0YXR1czogNTAwIH0pXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICBjb25zdCB7IHVzZXJJZCwgdXNlck5hbWUsIGxvY2F0aW9uLCBjYXRlZ29yeSwgcmF0aW5nLCB0ZXh0RmVlZGJhY2ssIGxhbmd1YWdlID0gJ2F1dG8nLCB2b2ljZURhdGEsIGltYWdlRGF0YSwgZW1vamlSYXRpbmcgfSA9IGJvZHlcblxuICAgIC8vIEFkdmFuY2VkIEFJIGFuYWx5c2lzXG4gICAgbGV0IGFpQW5hbHlzaXM6IEFJQW5hbHlzaXNSZXN1bHRcbiAgICBsZXQgdm9pY2VBbmFseXNpczogVm9pY2VBbmFseXNpc1Jlc3VsdCB8IHVuZGVmaW5lZFxuICAgIGxldCBpbWFnZUFuYWx5c2lzOiBJbWFnZUFuYWx5c2lzUmVzdWx0IHwgdW5kZWZpbmVkXG5cbiAgICB0cnkge1xuICAgICAgLy8gQ29udmVydCBiYXNlNjQgZGF0YSB0byBibG9icyBpZiBwcm92aWRlZFxuICAgICAgY29uc3Qgdm9pY2VCbG9iID0gdm9pY2VEYXRhID8gbmV3IEJsb2IoW0J1ZmZlci5mcm9tKHZvaWNlRGF0YSwgJ2Jhc2U2NCcpXSwgeyB0eXBlOiAnYXVkaW8vd2F2JyB9KSA6IHVuZGVmaW5lZFxuICAgICAgY29uc3QgaW1hZ2VCbG9iID0gaW1hZ2VEYXRhID8gbmV3IEJsb2IoW0J1ZmZlci5mcm9tKGltYWdlRGF0YSwgJ2Jhc2U2NCcpXSwgeyB0eXBlOiAnaW1hZ2UvanBlZycgfSkgOiB1bmRlZmluZWRcblxuICAgICAgY29uc3QgYW5hbHlzaXNSZXN1bHRzID0gYXdhaXQgYW5hbHl6ZUFkdmFuY2VkRmVlZGJhY2sodGV4dEZlZWRiYWNrLCB2b2ljZUJsb2IsIGltYWdlQmxvYiwgbGFuZ3VhZ2UpXG4gICAgICBhaUFuYWx5c2lzID0gYW5hbHlzaXNSZXN1bHRzLmFpQW5hbHlzaXMhXG4gICAgICB2b2ljZUFuYWx5c2lzID0gYW5hbHlzaXNSZXN1bHRzLnZvaWNlQW5hbHlzaXNcbiAgICAgIGltYWdlQW5hbHlzaXMgPSBhbmFseXNpc1Jlc3VsdHMuaW1hZ2VBbmFseXNpc1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdBSSBhbmFseXNpcyBmYWlsZWQsIHVzaW5nIGZhbGxiYWNrOicsIGVycm9yKVxuICAgICAgLy8gRmFsbGJhY2sgdG8gYmFzaWMgYW5hbHlzaXNcbiAgICAgIGFpQW5hbHlzaXMgPSB7XG4gICAgICAgIHNlbnRpbWVudDogJ25ldXRyYWwnLFxuICAgICAgICBjb25maWRlbmNlOiAwLjUsXG4gICAgICAgIGVtb3Rpb25zOiB7fSxcbiAgICAgICAga2V5d29yZHM6IFtdLFxuICAgICAgICBsYW5ndWFnZTogbGFuZ3VhZ2UgfHwgJ2VuJyxcbiAgICAgICAgdG94aWNpdHk6IDAsXG4gICAgICAgIHVyZ2VuY3k6ICdsb3cnLFxuICAgICAgICBjYXRlZ29yaWVzOiBbXSxcbiAgICAgICAgYWN0aW9uYWJsZUluc2lnaHRzOiBbXVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIERldGVybWluZSB1cmdlbmN5IGxldmVsXG4gICAgY29uc3QgdXJnZW5jeUxldmVsID0gYWlBbmFseXNpcy51cmdlbmN5IHx8ICdsb3cnXG5cbiAgICAvLyBDaGVjayBmb3IgZmxhZ2dpbmcgY29uZGl0aW9uc1xuICAgIGNvbnN0IGZsYWdnZWQgPSAoYWlBbmFseXNpcy5zZW50aW1lbnQgPT09ICduZWdhdGl2ZScgJiYgYWlBbmFseXNpcy5jb25maWRlbmNlID4gMC43KSB8fFxuICAgICAgICAgICAgICAgICAgIChhaUFuYWx5c2lzLnRveGljaXR5ICYmIGFpQW5hbHlzaXMudG94aWNpdHkgPiAwLjUpIHx8XG4gICAgICAgICAgICAgICAgICAgdXJnZW5jeUxldmVsID09PSAnY3JpdGljYWwnIHx8IHVyZ2VuY3lMZXZlbCA9PT0gJ2hpZ2gnXG5cbiAgICBjb25zdCBuZXdGZWVkYmFjazogRW5oYW5jZWRGZWVkYmFjayA9IHtcbiAgICAgIGlkOiBmZWVkYmFja3MubGVuZ3RoICsgMSxcbiAgICAgIHVzZXJJZCxcbiAgICAgIHVzZXJOYW1lLFxuICAgICAgbG9jYXRpb24sXG4gICAgICBjYXRlZ29yeSxcbiAgICAgIHJhdGluZyxcbiAgICAgIHRleHRGZWVkYmFjayxcbiAgICAgIGxhbmd1YWdlOiBhaUFuYWx5c2lzLmxhbmd1YWdlLFxuICAgICAgdm9pY2VEYXRhLFxuICAgICAgaW1hZ2VEYXRhLFxuICAgICAgZW1vamlSYXRpbmcsXG4gICAgICBhaUFuYWx5c2lzLFxuICAgICAgdm9pY2VBbmFseXNpcyxcbiAgICAgIGltYWdlQW5hbHlzaXMsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGlzVmVyaWZpZWQ6IGZhbHNlLFxuICAgICAgcmVzcG9uc2VGcm9tVmVuZG9yOiB1bmRlZmluZWQsXG4gICAgICBmbGFnZ2VkLFxuICAgICAgdXJnZW5jeUxldmVsXG4gICAgfVxuXG4gICAgLy8gR2VuZXJhdGUgYXV0by1yZXNwb25zZSB1c2luZyBBSSBjaGF0Ym90XG4gICAgdHJ5IHtcbiAgICAgIG5ld0ZlZWRiYWNrLmF1dG9SZXNwb25zZUdlbmVyYXRlZCA9IGF3YWl0IEZlZWRiYWNrQ2hhdGJvdC5nZW5lcmF0ZVJlc3BvbnNlKG5ld0ZlZWRiYWNrKVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdBdXRvLXJlc3BvbnNlIGdlbmVyYXRpb24gZmFpbGVkOicsIGVycm9yKVxuICAgIH1cblxuICAgIGZlZWRiYWNrcy5wdXNoKG5ld0ZlZWRiYWNrKVxuXG4gICAgLy8gQWRkIHRvIHNlbnRpbWVudCBtb25pdG9yaW5nXG4gICAgU2VudGltZW50TW9uaXRvci5hZGRTZW50aW1lbnQobmV3RmVlZGJhY2spXG5cbiAgICAvLyBUcmlnZ2VyIGFsZXJ0cyBmb3IgY3JpdGljYWwgaXNzdWVzXG4gICAgYXdhaXQgQWxlcnRTeXN0ZW0udHJpZ2dlckFsZXJ0KG5ld0ZlZWRiYWNrKVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIC4uLm5ld0ZlZWRiYWNrLFxuICAgICAgZm9sbG93VXBRdWVzdGlvbnM6IGF3YWl0IEZlZWRiYWNrQ2hhdGJvdC5nZW5lcmF0ZUZvbGxvd1VwUXVlc3Rpb25zKG5ld0ZlZWRiYWNrKVxuICAgIH0sIHsgc3RhdHVzOiAyMDEgfSlcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gc3VibWl0IGZlZWRiYWNrOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIHN1Ym1pdCBmZWVkYmFjaycgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQVVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICBjb25zdCB7IGZlZWRiYWNrSWQsIHJlc3BvbnNlRnJvbVZlbmRvciwgZmxhZ2dlZCB9ID0gYm9keVxuXG4gICAgY29uc3QgZmVlZGJhY2tJbmRleCA9IGZlZWRiYWNrcy5maW5kSW5kZXgoZiA9PiBmLmlkID09PSBmZWVkYmFja0lkKVxuICAgIGlmIChmZWVkYmFja0luZGV4ID09PSAtMSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdGZWVkYmFjayBub3QgZm91bmQnIH0sIHsgc3RhdHVzOiA0MDQgfSlcbiAgICB9XG5cbiAgICBmZWVkYmFja3NbZmVlZGJhY2tJbmRleF0gPSB7XG4gICAgICAuLi5mZWVkYmFja3NbZmVlZGJhY2tJbmRleF0sXG4gICAgICAuLi4ocmVzcG9uc2VGcm9tVmVuZG9yICYmIHsgcmVzcG9uc2VGcm9tVmVuZG9yIH0pLFxuICAgICAgLi4uKHR5cGVvZiBmbGFnZ2VkID09PSAnYm9vbGVhbicgJiYgeyBmbGFnZ2VkIH0pLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZmVlZGJhY2tzW2ZlZWRiYWNrSW5kZXhdKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIHVwZGF0ZSBmZWVkYmFjaycgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiYWlTZXJ2aWNlIiwiQWxlcnRTeXN0ZW0iLCJ0cmlnZ2VyQWxlcnQiLCJmZWVkYmFjayIsInVyZ2VuY3lMZXZlbCIsImNvbnNvbGUiLCJsb2ciLCJsb2NhdGlvbiIsImNhdGVnb3J5IiwiYWlBbmFseXNpcyIsImFjdGlvbmFibGVJbnNpZ2h0cyIsImpvaW4iLCJhdXRvUmVzcG9uc2VHZW5lcmF0ZWQiLCJnZW5lcmF0ZUF1dG9SZXNwb25zZSIsImVzY2FsYXRlZCIsImluc2lnaHRzIiwic29tZSIsImkiLCJpbmNsdWRlcyIsInNlbnRpbWVudCIsImNvbmZpZGVuY2UiLCJhbmFseXplQWR2YW5jZWRGZWVkYmFjayIsInRleHRGZWVkYmFjayIsInZvaWNlQmxvYiIsImltYWdlQmxvYiIsImxhbmd1YWdlIiwicmVzdWx0cyIsImFuYWx5emVUZXh0Iiwidm9pY2VBbmFseXNpcyIsImFuYWx5emVWb2ljZSIsInRyYW5zY3JpcHRpb24iLCJpbWFnZUFuYWx5c2lzIiwiYW5hbHl6ZUltYWdlIiwiZXJyb3IiLCJTZW50aW1lbnRNb25pdG9yIiwic2VudGltZW50SGlzdG9yeSIsImFkZFNlbnRpbWVudCIsInB1c2giLCJ0aW1lc3RhbXAiLCJsZW5ndGgiLCJzbGljZSIsImNoZWNrU2VudGltZW50VHJlbmRzIiwicmVjZW50RmVlZGJhY2tzIiwiZmlsdGVyIiwicyIsIm5lZ2F0aXZlRmVlZGJhY2tzIiwiZ2V0U2VudGltZW50VHJlbmRzIiwiZmlsdGVyZWQiLCJGZWVkYmFja0NoYXRib3QiLCJnZW5lcmF0ZVJlc3BvbnNlIiwidXJnZW5jeSIsImNhdGVnb3JpZXMiLCJrZXl3b3JkcyIsImlzc3VlcyIsInRvTG93ZXJDYXNlIiwiZ2VuZXJhdGVGb2xsb3dVcFF1ZXN0aW9ucyIsInF1ZXN0aW9ucyIsImZhbGxiYWNrU2VudGltZW50QW5hbHlzaXMiLCJ0ZXh0IiwicG9zaXRpdmVXb3JkcyIsIm5lZ2F0aXZlV29yZHMiLCJoaW5kaVBvc2l0aXZlIiwiaGluZGlOZWdhdGl2ZSIsIndvcmRzIiwic3BsaXQiLCJwb3NpdGl2ZUNvdW50IiwibmVnYXRpdmVDb3VudCIsImZvckVhY2giLCJ3b3JkIiwiTWF0aCIsIm1pbiIsImVtb3Rpb25zIiwiam95IiwiYW5nZXIiLCJzYWRuZXNzIiwic3VycHJpc2UiLCJmZWFyIiwiZGlzZ3VzdCIsImZlZWRiYWNrcyIsImlkIiwidXNlcklkIiwidXNlck5hbWUiLCJyYXRpbmciLCJzYXRpc2ZhY3Rpb24iLCJleGNpdGVtZW50IiwidG94aWNpdHkiLCJEYXRlIiwidG9JU09TdHJpbmciLCJpc1ZlcmlmaWVkIiwicmVzcG9uc2VGcm9tVmVuZG9yIiwidW5kZWZpbmVkIiwiZmxhZ2dlZCIsImRpc2FwcG9pbnRtZW50IiwiZnJ1c3RyYXRpb24iLCJub3ciLCJHRVQiLCJyZXF1ZXN0Iiwic2VhcmNoUGFyYW1zIiwiVVJMIiwidXJsIiwiZ2V0IiwibGltaXQiLCJwYXJzZUludCIsIm9mZnNldCIsImZpbHRlcmVkRmVlZGJhY2tzIiwiZiIsInNvcnQiLCJhIiwiYiIsImdldFRpbWUiLCJwYWdpbmF0ZWRGZWVkYmFja3MiLCJzZW50aW1lbnRTdGF0cyIsInBvc2l0aXZlIiwibmVnYXRpdmUiLCJuZXV0cmFsIiwidG90YWwiLCJ1cmdlbmN5U3RhdHMiLCJjcml0aWNhbCIsImhpZ2giLCJtZWRpdW0iLCJsb3ciLCJzZW50aW1lbnRUcmVuZHMiLCJqc29uIiwiaGFzTW9yZSIsInN0YXR1cyIsIlBPU1QiLCJib2R5Iiwidm9pY2VEYXRhIiwiaW1hZ2VEYXRhIiwiZW1vamlSYXRpbmciLCJCbG9iIiwiQnVmZmVyIiwiZnJvbSIsInR5cGUiLCJhbmFseXNpc1Jlc3VsdHMiLCJuZXdGZWVkYmFjayIsImZvbGxvd1VwUXVlc3Rpb25zIiwiUFVUIiwiZmVlZGJhY2tJZCIsImZlZWRiYWNrSW5kZXgiLCJmaW5kSW5kZXgiLCJ1cGRhdGVkQXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/feedback/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/ai-services.ts":
/*!****************************!*\
  !*** ./lib/ai-services.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AdvancedAIService: () => (/* binding */ AdvancedAIService),\n/* harmony export */   aiService: () => (/* binding */ aiService)\n/* harmony export */ });\n// Advanced AI Services for Tourism Jharkhand\n// Integrates multiple AI APIs for comprehensive analysis\n// Advanced multilingual sentiment analysis with multiple AI models\nclass AdvancedAIService {\n    constructor(){\n        this.huggingFaceKey = process.env.HUGGINGFACE_API_KEY || \"\";\n        this.openAIKey = process.env.OPENAI_API_KEY;\n        this.googleCloudKey = process.env.GOOGLE_CLOUD_API_KEY;\n    }\n    // Enhanced text analysis with multiple AI models\n    async analyzeText(text, language = \"auto\") {\n        try {\n            // Detect language if not specified\n            const detectedLanguage = language === \"auto\" ? await this.detectLanguage(text) : language;\n            // Run multiple AI analyses in parallel\n            const [sentimentResult, emotionResult, toxicityResult, categoryResult] = await Promise.allSettled([\n                this.analyzeSentiment(text, detectedLanguage),\n                this.analyzeEmotions(text),\n                this.analyzeToxicity(text),\n                this.categorizeText(text)\n            ]);\n            // Extract keywords using advanced NLP\n            const keywords = await this.extractAdvancedKeywords(text, detectedLanguage);\n            // Generate actionable insights\n            const insights = await this.generateActionableInsights(text, detectedLanguage);\n            // Determine urgency level\n            const urgency = this.calculateUrgency(sentimentResult.status === \"fulfilled\" ? sentimentResult.value : null, toxicityResult.status === \"fulfilled\" ? toxicityResult.value : 0);\n            return {\n                sentiment: sentimentResult.status === \"fulfilled\" ? sentimentResult.value.sentiment : \"neutral\",\n                confidence: sentimentResult.status === \"fulfilled\" ? sentimentResult.value.confidence : 0.5,\n                emotions: emotionResult.status === \"fulfilled\" ? emotionResult.value : {},\n                keywords,\n                language: detectedLanguage,\n                toxicity: toxicityResult.status === \"fulfilled\" ? toxicityResult.value : 0,\n                urgency,\n                categories: categoryResult.status === \"fulfilled\" ? categoryResult.value : [],\n                actionableInsights: insights\n            };\n        } catch (error) {\n            console.error(\"Advanced AI analysis failed:\", error);\n            return this.fallbackAnalysis(text, language);\n        }\n    }\n    // Voice analysis with speech-to-text and emotion detection\n    async analyzeVoice(audioBlob) {\n        try {\n            // Convert audio to text using Hugging Face Whisper\n            const transcription = await this.speechToText(audioBlob);\n            // Analyze the transcribed text\n            const textAnalysis = await this.analyzeText(transcription);\n            // Analyze voice tone and emotions from audio\n            const voiceEmotions = await this.analyzeVoiceEmotions(audioBlob);\n            return {\n                transcription,\n                sentiment: textAnalysis.sentiment,\n                confidence: textAnalysis.confidence,\n                emotions: {\n                    ...textAnalysis.emotions,\n                    ...voiceEmotions\n                },\n                speakerTone: this.determineSpeakerTone(voiceEmotions),\n                language: textAnalysis.language\n            };\n        } catch (error) {\n            console.error(\"Voice analysis failed:\", error);\n            throw new Error(\"Voice analysis service unavailable\");\n        }\n    }\n    // Image analysis for visual feedback\n    async analyzeImage(imageBlob) {\n        try {\n            // Convert image to base64\n            const base64Image = await this.blobToBase64(imageBlob);\n            // Analyze image content using Hugging Face Vision models\n            const [description, objects, sentiment] = await Promise.all([\n                this.generateImageDescription(base64Image),\n                this.detectObjects(base64Image),\n                this.analyzeImageSentiment(base64Image)\n            ]);\n            // Assess image quality\n            const quality = await this.assessImageQuality(base64Image);\n            // Detect potential issues\n            const issues = await this.detectImageIssues(base64Image, objects);\n            return {\n                description,\n                objects,\n                sentiment,\n                quality,\n                issues,\n                location: await this.extractLocationFromImage(base64Image)\n            };\n        } catch (error) {\n            console.error(\"Image analysis failed:\", error);\n            throw new Error(\"Image analysis service unavailable\");\n        }\n    }\n    // Language detection using AI\n    async detectLanguage(text) {\n        try {\n            const response = await fetch(\"https://api-inference.huggingface.co/models/facebook/fasttext-language-identification\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: text\n                })\n            });\n            if (response.ok) {\n                const result = await response.json();\n                return result[0]?.label?.replace(\"__label__\", \"\") || \"en\";\n            }\n        } catch (error) {\n            console.error(\"Language detection failed:\", error);\n        }\n        return \"en\";\n    }\n    // Enhanced sentiment analysis with multiple models\n    async analyzeSentiment(text, language) {\n        const models = [\n            \"cardiffnlp/twitter-roberta-base-sentiment-latest\",\n            \"nlptown/bert-base-multilingual-uncased-sentiment\"\n        ];\n        for (const model of models){\n            try {\n                const response = await fetch(`https://api-inference.huggingface.co/models/${model}`, {\n                    headers: {\n                        \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                        \"Content-Type\": \"application/json\"\n                    },\n                    method: \"POST\",\n                    body: JSON.stringify({\n                        inputs: text\n                    })\n                });\n                if (response.ok) {\n                    const result = await response.json();\n                    if (Array.isArray(result) && result.length > 0) {\n                        const topResult = result[0];\n                        return {\n                            sentiment: this.normalizeSentiment(topResult.label),\n                            confidence: topResult.score\n                        };\n                    }\n                }\n            } catch (error) {\n                console.error(`Sentiment analysis with ${model} failed:`, error);\n            }\n        }\n        throw new Error(\"All sentiment analysis models failed\");\n    }\n    // Advanced emotion analysis\n    async analyzeEmotions(text) {\n        try {\n            const response = await fetch(\"https://api-inference.huggingface.co/models/j-hartmann/emotion-english-distilroberta-base\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: text\n                })\n            });\n            if (response.ok) {\n                const emotions = await response.json();\n                if (Array.isArray(emotions) && emotions.length > 0) {\n                    const emotionScores = {};\n                    emotions[0].forEach((emotion)=>{\n                        emotionScores[emotion.label.toLowerCase()] = emotion.score;\n                    });\n                    return emotionScores;\n                }\n            }\n        } catch (error) {\n            console.error(\"Emotion analysis failed:\", error);\n        }\n        return {};\n    }\n    // Toxicity detection\n    async analyzeToxicity(text) {\n        try {\n            const response = await fetch(\"https://api-inference.huggingface.co/models/unitary/toxic-bert\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: text\n                })\n            });\n            if (response.ok) {\n                const result = await response.json();\n                if (Array.isArray(result) && result.length > 0) {\n                    const toxicResult = result[0].find((r)=>r.label === \"TOXIC\");\n                    return toxicResult ? toxicResult.score : 0;\n                }\n            }\n        } catch (error) {\n            console.error(\"Toxicity analysis failed:\", error);\n        }\n        return 0;\n    }\n    // Text categorization\n    async categorizeText(text) {\n        try {\n            const response = await fetch(\"https://api-inference.huggingface.co/models/facebook/bart-large-mnli\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: text,\n                    parameters: {\n                        candidate_labels: [\n                            \"accommodation\",\n                            \"food\",\n                            \"transportation\",\n                            \"attractions\",\n                            \"service quality\",\n                            \"cleanliness\",\n                            \"safety\",\n                            \"pricing\",\n                            \"accessibility\",\n                            \"cultural experience\"\n                        ]\n                    }\n                })\n            });\n            if (response.ok) {\n                const result = await response.json();\n                return result.labels?.slice(0, 3) || [];\n            }\n        } catch (error) {\n            console.error(\"Text categorization failed:\", error);\n        }\n        return [];\n    }\n    // Advanced keyword extraction using TF-IDF and NER\n    async extractAdvancedKeywords(text, language) {\n        try {\n            // Named Entity Recognition\n            const response = await fetch(\"https://api-inference.huggingface.co/models/dbmdz/bert-large-cased-finetuned-conll03-english\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: text\n                })\n            });\n            const entities = [];\n            if (response.ok) {\n                const result = await response.json();\n                if (Array.isArray(result)) {\n                    result.forEach((entity)=>{\n                        if (entity.entity_group && entity.word) {\n                            entities.push(entity.word.replace(\"##\", \"\"));\n                        }\n                    });\n                }\n            }\n            // Combine with TF-IDF keywords\n            const tfidfKeywords = this.extractTFIDFKeywords(text);\n            return [\n                ...new Set([\n                    ...entities,\n                    ...tfidfKeywords\n                ])\n            ].slice(0, 10);\n        } catch (error) {\n            console.error(\"Advanced keyword extraction failed:\", error);\n            return this.extractTFIDFKeywords(text);\n        }\n    }\n    // Generate actionable insights using AI\n    async generateActionableInsights(text, language) {\n        const insights = [];\n        // Rule-based insights for now (can be enhanced with GPT-4 later)\n        const lowercaseText = text.toLowerCase();\n        if (lowercaseText.includes(\"dirty\") || lowercaseText.includes(\"unclean\")) {\n            insights.push(\"Immediate cleaning and hygiene improvement required\");\n        }\n        if (lowercaseText.includes(\"expensive\") || lowercaseText.includes(\"overpriced\")) {\n            insights.push(\"Review pricing strategy and provide value justification\");\n        }\n        if (lowercaseText.includes(\"rude\") || lowercaseText.includes(\"unprofessional\")) {\n            insights.push(\"Staff training and customer service improvement needed\");\n        }\n        if (lowercaseText.includes(\"unsafe\") || lowercaseText.includes(\"dangerous\")) {\n            insights.push(\"URGENT: Safety assessment and security measures required\");\n        }\n        if (lowercaseText.includes(\"beautiful\") || lowercaseText.includes(\"amazing\")) {\n            insights.push(\"Leverage positive aspects in marketing and promotion\");\n        }\n        return insights;\n    }\n    // Calculate urgency level\n    calculateUrgency(sentiment, toxicity) {\n        if (toxicity > 0.8 || sentiment?.sentiment === \"negative\" && sentiment?.confidence > 0.9) {\n            return \"critical\";\n        }\n        if (toxicity > 0.6 || sentiment?.sentiment === \"negative\" && sentiment?.confidence > 0.7) {\n            return \"high\";\n        }\n        if (toxicity > 0.3 || sentiment?.sentiment === \"negative\" && sentiment?.confidence > 0.5) {\n            return \"medium\";\n        }\n        return \"low\";\n    }\n    // Speech to text conversion\n    async speechToText(audioBlob) {\n        try {\n            const formData = new FormData();\n            formData.append(\"file\", audioBlob, \"audio.wav\");\n            const response = await fetch(\"https://api-inference.huggingface.co/models/openai/whisper-large-v3\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`\n                },\n                method: \"POST\",\n                body: formData\n            });\n            if (response.ok) {\n                const result = await response.json();\n                return result.text || \"\";\n            }\n        } catch (error) {\n            console.error(\"Speech to text failed:\", error);\n        }\n        return \"\";\n    }\n    // Voice emotion analysis\n    async analyzeVoiceEmotions(audioBlob) {\n        // Placeholder for voice emotion analysis\n        // In production, this would use specialized audio emotion recognition models\n        return {\n            calm: 0.3,\n            excited: 0.2,\n            frustrated: 0.1,\n            happy: 0.4\n        };\n    }\n    // Determine speaker tone from voice emotions\n    determineSpeakerTone(emotions) {\n        const maxEmotion = Object.entries(emotions).reduce((a, b)=>a[1] > b[1] ? a : b);\n        return maxEmotion[0] || \"calm\";\n    }\n    // Image description generation\n    async generateImageDescription(base64Image) {\n        try {\n            const response = await fetch(\"https://api-inference.huggingface.co/models/Salesforce/blip-image-captioning-large\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: base64Image\n                })\n            });\n            if (response.ok) {\n                const result = await response.json();\n                return result[0]?.generated_text || \"Unable to generate description\";\n            }\n        } catch (error) {\n            console.error(\"Image description failed:\", error);\n        }\n        return \"Image analysis unavailable\";\n    }\n    // Object detection in images\n    async detectObjects(base64Image) {\n        try {\n            const response = await fetch(\"https://api-inference.huggingface.co/models/facebook/detr-resnet-50\", {\n                headers: {\n                    \"Authorization\": `Bearer ${this.huggingFaceKey}`,\n                    \"Content-Type\": \"application/json\"\n                },\n                method: \"POST\",\n                body: JSON.stringify({\n                    inputs: base64Image\n                })\n            });\n            if (response.ok) {\n                const result = await response.json();\n                return result.map((obj)=>obj.label).slice(0, 10);\n            }\n        } catch (error) {\n            console.error(\"Object detection failed:\", error);\n        }\n        return [];\n    }\n    // Image sentiment analysis\n    async analyzeImageSentiment(base64Image) {\n        // Placeholder - would use specialized image sentiment models\n        return \"neutral\";\n    }\n    // Assess image quality\n    async assessImageQuality(base64Image) {\n        // Placeholder - would use image quality assessment models\n        return Math.random() * 0.3 + 0.7 // Random quality between 0.7-1.0\n        ;\n    }\n    // Detect issues in images\n    async detectImageIssues(base64Image, objects) {\n        const issues = [];\n        // Rule-based issue detection\n        if (objects.includes(\"trash\") || objects.includes(\"garbage\")) {\n            issues.push(\"Cleanliness issue detected\");\n        }\n        if (objects.includes(\"damage\") || objects.includes(\"broken\")) {\n            issues.push(\"Infrastructure damage detected\");\n        }\n        return issues;\n    }\n    // Extract location from image metadata\n    async extractLocationFromImage(base64Image) {\n        // Placeholder - would extract GPS data from EXIF or use image recognition\n        return undefined;\n    }\n    // Utility functions\n    async blobToBase64(blob) {\n        return new Promise((resolve, reject)=>{\n            const reader = new FileReader();\n            reader.onloadend = ()=>resolve(reader.result);\n            reader.onerror = reject;\n            reader.readAsDataURL(blob);\n        });\n    }\n    normalizeSentiment(label) {\n        const normalized = label.toLowerCase();\n        if (normalized.includes(\"positive\") || normalized.includes(\"pos\")) return \"positive\";\n        if (normalized.includes(\"negative\") || normalized.includes(\"neg\")) return \"negative\";\n        return \"neutral\";\n    }\n    extractTFIDFKeywords(text) {\n        const stopWords = new Set([\n            \"the\",\n            \"a\",\n            \"an\",\n            \"and\",\n            \"or\",\n            \"but\",\n            \"in\",\n            \"on\",\n            \"at\",\n            \"to\",\n            \"for\",\n            \"of\",\n            \"with\",\n            \"by\",\n            \"is\",\n            \"was\",\n            \"are\",\n            \"were\",\n            \"be\",\n            \"been\",\n            \"have\",\n            \"has\",\n            \"had\",\n            \"do\",\n            \"does\",\n            \"did\",\n            \"will\",\n            \"would\",\n            \"could\",\n            \"should\",\n            \"may\",\n            \"might\",\n            \"must\",\n            \"can\",\n            \"this\",\n            \"that\",\n            \"these\",\n            \"those\",\n            \"i\",\n            \"you\",\n            \"he\",\n            \"she\",\n            \"it\",\n            \"we\",\n            \"they\",\n            \"me\",\n            \"him\",\n            \"her\",\n            \"us\",\n            \"them\"\n        ]);\n        const words = text.toLowerCase().replace(/[^\\w\\s]/g, \"\").split(/\\s+/).filter((word)=>word.length > 2 && !stopWords.has(word));\n        const wordCount = {};\n        words.forEach((word)=>{\n            wordCount[word] = (wordCount[word] || 0) + 1;\n        });\n        return Object.entries(wordCount).sort(([, a], [, b])=>b - a).slice(0, 5).map(([word])=>word);\n    }\n    fallbackAnalysis(text, language) {\n        // Simple rule-based fallback\n        const positiveWords = [\n            \"good\",\n            \"great\",\n            \"excellent\",\n            \"amazing\",\n            \"wonderful\",\n            \"beautiful\",\n            \"love\",\n            \"perfect\"\n        ];\n        const negativeWords = [\n            \"bad\",\n            \"terrible\",\n            \"awful\",\n            \"horrible\",\n            \"hate\",\n            \"worst\",\n            \"disappointing\",\n            \"poor\"\n        ];\n        const words = text.toLowerCase().split(/\\s+/);\n        const positiveCount = words.filter((word)=>positiveWords.includes(word)).length;\n        const negativeCount = words.filter((word)=>negativeWords.includes(word)).length;\n        let sentiment = \"neutral\";\n        let confidence = 0.5;\n        if (positiveCount > negativeCount) {\n            sentiment = \"positive\";\n            confidence = Math.min(0.8, 0.5 + (positiveCount - negativeCount) * 0.1);\n        } else if (negativeCount > positiveCount) {\n            sentiment = \"negative\";\n            confidence = Math.min(0.8, 0.5 + (negativeCount - positiveCount) * 0.1);\n        }\n        return {\n            sentiment,\n            confidence,\n            emotions: {\n                joy: sentiment === \"positive\" ? confidence * 0.8 : 0.1,\n                anger: sentiment === \"negative\" ? confidence * 0.6 : 0.1,\n                sadness: sentiment === \"negative\" ? confidence * 0.4 : 0.1\n            },\n            keywords: this.extractTFIDFKeywords(text),\n            language: language || \"en\",\n            toxicity: 0,\n            urgency: \"low\",\n            categories: [],\n            actionableInsights: []\n        };\n    }\n}\n// Singleton instance\nconst aiService = new AdvancedAIService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUlDLGFBQWE7UUFFakIsSUFBSWlILGdCQUFnQkMsZUFBZTtZQUNqQ25ILFlBQVk7WUFDWkMsYUFBYTRGLEtBQUt1QixHQUFHLENBQUMsS0FBSyxNQUFNLENBQUNGLGdCQUFnQkMsYUFBWSxJQUFLO1FBQ3JFLE9BQU8sSUFBSUEsZ0JBQWdCRCxlQUFlO1lBQ3hDbEgsWUFBWTtZQUNaQyxhQUFhNEYsS0FBS3VCLEdBQUcsQ0FBQyxLQUFLLE1BQU0sQ0FBQ0QsZ0JBQWdCRCxhQUFZLElBQUs7UUFDckU7UUFFQSxPQUFPO1lBQ0xsSDtZQUNBQztZQUNBQyxVQUFVO2dCQUNSbUgsS0FBS3JILGNBQWMsYUFBYUMsYUFBYSxNQUFNO2dCQUNuRHFILE9BQU90SCxjQUFjLGFBQWFDLGFBQWEsTUFBTTtnQkFDckRzSCxTQUFTdkgsY0FBYyxhQUFhQyxhQUFhLE1BQU07WUFDekQ7WUFDQVQsVUFBVSxJQUFJLENBQUNpRixvQkFBb0IsQ0FBQy9GO1lBQ3BDQyxVQUFVQSxZQUFZO1lBQ3RCd0IsVUFBVTtZQUNWUCxTQUFTO1lBQ1RRLFlBQVksRUFBRTtZQUNkQyxvQkFBb0IsRUFBRTtRQUN4QjtJQUNGO0FBQ0Y7QUFFQSxxQkFBcUI7QUFDZCxNQUFNbUgsWUFBWSxJQUFJekosb0JBQW1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktdjAtcHJvamVjdC8uL2xpYi9haS1zZXJ2aWNlcy50cz85MThiIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEFkdmFuY2VkIEFJIFNlcnZpY2VzIGZvciBUb3VyaXNtIEpoYXJraGFuZFxuLy8gSW50ZWdyYXRlcyBtdWx0aXBsZSBBSSBBUElzIGZvciBjb21wcmVoZW5zaXZlIGFuYWx5c2lzXG5cbmV4cG9ydCBpbnRlcmZhY2UgQUlBbmFseXNpc1Jlc3VsdCB7XG4gIHNlbnRpbWVudDogJ3Bvc2l0aXZlJyB8ICduZWdhdGl2ZScgfCAnbmV1dHJhbCdcbiAgY29uZmlkZW5jZTogbnVtYmVyXG4gIGVtb3Rpb25zOiB7IFtrZXk6IHN0cmluZ106IG51bWJlciB9XG4gIGtleXdvcmRzOiBzdHJpbmdbXVxuICBsYW5ndWFnZTogc3RyaW5nXG4gIHRveGljaXR5PzogbnVtYmVyXG4gIHVyZ2VuY3k/OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJ1xuICBjYXRlZ29yaWVzPzogc3RyaW5nW11cbiAgYWN0aW9uYWJsZUluc2lnaHRzPzogc3RyaW5nW11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBWb2ljZUFuYWx5c2lzUmVzdWx0IHtcbiAgdHJhbnNjcmlwdGlvbjogc3RyaW5nXG4gIHNlbnRpbWVudDogJ3Bvc2l0aXZlJyB8ICduZWdhdGl2ZScgfCAnbmV1dHJhbCdcbiAgY29uZmlkZW5jZTogbnVtYmVyXG4gIGVtb3Rpb25zOiB7IFtrZXk6IHN0cmluZ106IG51bWJlciB9XG4gIHNwZWFrZXJUb25lOiAnY2FsbScgfCAnZXhjaXRlZCcgfCAnZnJ1c3RyYXRlZCcgfCAnYW5ncnknIHwgJ2hhcHB5J1xuICBsYW5ndWFnZTogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW1hZ2VBbmFseXNpc1Jlc3VsdCB7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmdcbiAgb2JqZWN0czogc3RyaW5nW11cbiAgc2VudGltZW50OiAncG9zaXRpdmUnIHwgJ25lZ2F0aXZlJyB8ICduZXV0cmFsJ1xuICBxdWFsaXR5OiBudW1iZXJcbiAgaXNzdWVzPzogc3RyaW5nW11cbiAgbG9jYXRpb24/OiBzdHJpbmdcbn1cblxuLy8gQWR2YW5jZWQgbXVsdGlsaW5ndWFsIHNlbnRpbWVudCBhbmFseXNpcyB3aXRoIG11bHRpcGxlIEFJIG1vZGVsc1xuZXhwb3J0IGNsYXNzIEFkdmFuY2VkQUlTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBodWdnaW5nRmFjZUtleTogc3RyaW5nXG4gIHByaXZhdGUgb3BlbkFJS2V5Pzogc3RyaW5nXG4gIHByaXZhdGUgZ29vZ2xlQ2xvdWRLZXk/OiBzdHJpbmdcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmh1Z2dpbmdGYWNlS2V5ID0gcHJvY2Vzcy5lbnYuSFVHR0lOR0ZBQ0VfQVBJX0tFWSB8fCAnJ1xuICAgIHRoaXMub3BlbkFJS2V5ID0gcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVlcbiAgICB0aGlzLmdvb2dsZUNsb3VkS2V5ID0gcHJvY2Vzcy5lbnYuR09PR0xFX0NMT1VEX0FQSV9LRVlcbiAgfVxuXG4gIC8vIEVuaGFuY2VkIHRleHQgYW5hbHlzaXMgd2l0aCBtdWx0aXBsZSBBSSBtb2RlbHNcbiAgYXN5bmMgYW5hbHl6ZVRleHQodGV4dDogc3RyaW5nLCBsYW5ndWFnZTogc3RyaW5nID0gJ2F1dG8nKTogUHJvbWlzZTxBSUFuYWx5c2lzUmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIERldGVjdCBsYW5ndWFnZSBpZiBub3Qgc3BlY2lmaWVkXG4gICAgICBjb25zdCBkZXRlY3RlZExhbmd1YWdlID0gbGFuZ3VhZ2UgPT09ICdhdXRvJyA/IGF3YWl0IHRoaXMuZGV0ZWN0TGFuZ3VhZ2UodGV4dCkgOiBsYW5ndWFnZVxuXG4gICAgICAvLyBSdW4gbXVsdGlwbGUgQUkgYW5hbHlzZXMgaW4gcGFyYWxsZWxcbiAgICAgIGNvbnN0IFtzZW50aW1lbnRSZXN1bHQsIGVtb3Rpb25SZXN1bHQsIHRveGljaXR5UmVzdWx0LCBjYXRlZ29yeVJlc3VsdF0gPSBhd2FpdCBQcm9taXNlLmFsbFNldHRsZWQoW1xuICAgICAgICB0aGlzLmFuYWx5emVTZW50aW1lbnQodGV4dCwgZGV0ZWN0ZWRMYW5ndWFnZSksXG4gICAgICAgIHRoaXMuYW5hbHl6ZUVtb3Rpb25zKHRleHQpLFxuICAgICAgICB0aGlzLmFuYWx5emVUb3hpY2l0eSh0ZXh0KSxcbiAgICAgICAgdGhpcy5jYXRlZ29yaXplVGV4dCh0ZXh0KVxuICAgICAgXSlcblxuICAgICAgLy8gRXh0cmFjdCBrZXl3b3JkcyB1c2luZyBhZHZhbmNlZCBOTFBcbiAgICAgIGNvbnN0IGtleXdvcmRzID0gYXdhaXQgdGhpcy5leHRyYWN0QWR2YW5jZWRLZXl3b3Jkcyh0ZXh0LCBkZXRlY3RlZExhbmd1YWdlKVxuXG4gICAgICAvLyBHZW5lcmF0ZSBhY3Rpb25hYmxlIGluc2lnaHRzXG4gICAgICBjb25zdCBpbnNpZ2h0cyA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVBY3Rpb25hYmxlSW5zaWdodHModGV4dCwgZGV0ZWN0ZWRMYW5ndWFnZSlcblxuICAgICAgLy8gRGV0ZXJtaW5lIHVyZ2VuY3kgbGV2ZWxcbiAgICAgIGNvbnN0IHVyZ2VuY3kgPSB0aGlzLmNhbGN1bGF0ZVVyZ2VuY3koXG4gICAgICAgIHNlbnRpbWVudFJlc3VsdC5zdGF0dXMgPT09ICdmdWxmaWxsZWQnID8gc2VudGltZW50UmVzdWx0LnZhbHVlIDogbnVsbCxcbiAgICAgICAgdG94aWNpdHlSZXN1bHQuc3RhdHVzID09PSAnZnVsZmlsbGVkJyA/IHRveGljaXR5UmVzdWx0LnZhbHVlIDogMFxuICAgICAgKVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzZW50aW1lbnQ6IHNlbnRpbWVudFJlc3VsdC5zdGF0dXMgPT09ICdmdWxmaWxsZWQnID8gc2VudGltZW50UmVzdWx0LnZhbHVlLnNlbnRpbWVudCA6ICduZXV0cmFsJyxcbiAgICAgICAgY29uZmlkZW5jZTogc2VudGltZW50UmVzdWx0LnN0YXR1cyA9PT0gJ2Z1bGZpbGxlZCcgPyBzZW50aW1lbnRSZXN1bHQudmFsdWUuY29uZmlkZW5jZSA6IDAuNSxcbiAgICAgICAgZW1vdGlvbnM6IGVtb3Rpb25SZXN1bHQuc3RhdHVzID09PSAnZnVsZmlsbGVkJyA/IGVtb3Rpb25SZXN1bHQudmFsdWUgOiB7fSxcbiAgICAgICAga2V5d29yZHMsXG4gICAgICAgIGxhbmd1YWdlOiBkZXRlY3RlZExhbmd1YWdlLFxuICAgICAgICB0b3hpY2l0eTogdG94aWNpdHlSZXN1bHQuc3RhdHVzID09PSAnZnVsZmlsbGVkJyA/IHRveGljaXR5UmVzdWx0LnZhbHVlIDogMCxcbiAgICAgICAgdXJnZW5jeSxcbiAgICAgICAgY2F0ZWdvcmllczogY2F0ZWdvcnlSZXN1bHQuc3RhdHVzID09PSAnZnVsZmlsbGVkJyA/IGNhdGVnb3J5UmVzdWx0LnZhbHVlIDogW10sXG4gICAgICAgIGFjdGlvbmFibGVJbnNpZ2h0czogaW5zaWdodHNcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignQWR2YW5jZWQgQUkgYW5hbHlzaXMgZmFpbGVkOicsIGVycm9yKVxuICAgICAgcmV0dXJuIHRoaXMuZmFsbGJhY2tBbmFseXNpcyh0ZXh0LCBsYW5ndWFnZSlcbiAgICB9XG4gIH1cblxuICAvLyBWb2ljZSBhbmFseXNpcyB3aXRoIHNwZWVjaC10by10ZXh0IGFuZCBlbW90aW9uIGRldGVjdGlvblxuICBhc3luYyBhbmFseXplVm9pY2UoYXVkaW9CbG9iOiBCbG9iKTogUHJvbWlzZTxWb2ljZUFuYWx5c2lzUmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENvbnZlcnQgYXVkaW8gdG8gdGV4dCB1c2luZyBIdWdnaW5nIEZhY2UgV2hpc3BlclxuICAgICAgY29uc3QgdHJhbnNjcmlwdGlvbiA9IGF3YWl0IHRoaXMuc3BlZWNoVG9UZXh0KGF1ZGlvQmxvYilcbiAgICAgIFxuICAgICAgLy8gQW5hbHl6ZSB0aGUgdHJhbnNjcmliZWQgdGV4dFxuICAgICAgY29uc3QgdGV4dEFuYWx5c2lzID0gYXdhaXQgdGhpcy5hbmFseXplVGV4dCh0cmFuc2NyaXB0aW9uKVxuICAgICAgXG4gICAgICAvLyBBbmFseXplIHZvaWNlIHRvbmUgYW5kIGVtb3Rpb25zIGZyb20gYXVkaW9cbiAgICAgIGNvbnN0IHZvaWNlRW1vdGlvbnMgPSBhd2FpdCB0aGlzLmFuYWx5emVWb2ljZUVtb3Rpb25zKGF1ZGlvQmxvYilcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHJhbnNjcmlwdGlvbixcbiAgICAgICAgc2VudGltZW50OiB0ZXh0QW5hbHlzaXMuc2VudGltZW50LFxuICAgICAgICBjb25maWRlbmNlOiB0ZXh0QW5hbHlzaXMuY29uZmlkZW5jZSxcbiAgICAgICAgZW1vdGlvbnM6IHsgLi4udGV4dEFuYWx5c2lzLmVtb3Rpb25zLCAuLi52b2ljZUVtb3Rpb25zIH0sXG4gICAgICAgIHNwZWFrZXJUb25lOiB0aGlzLmRldGVybWluZVNwZWFrZXJUb25lKHZvaWNlRW1vdGlvbnMpLFxuICAgICAgICBsYW5ndWFnZTogdGV4dEFuYWx5c2lzLmxhbmd1YWdlXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1ZvaWNlIGFuYWx5c2lzIGZhaWxlZDonLCBlcnJvcilcbiAgICAgIHRocm93IG5ldyBFcnJvcignVm9pY2UgYW5hbHlzaXMgc2VydmljZSB1bmF2YWlsYWJsZScpXG4gICAgfVxuICB9XG5cbiAgLy8gSW1hZ2UgYW5hbHlzaXMgZm9yIHZpc3VhbCBmZWVkYmFja1xuICBhc3luYyBhbmFseXplSW1hZ2UoaW1hZ2VCbG9iOiBCbG9iKTogUHJvbWlzZTxJbWFnZUFuYWx5c2lzUmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIENvbnZlcnQgaW1hZ2UgdG8gYmFzZTY0XG4gICAgICBjb25zdCBiYXNlNjRJbWFnZSA9IGF3YWl0IHRoaXMuYmxvYlRvQmFzZTY0KGltYWdlQmxvYilcbiAgICAgIFxuICAgICAgLy8gQW5hbHl6ZSBpbWFnZSBjb250ZW50IHVzaW5nIEh1Z2dpbmcgRmFjZSBWaXNpb24gbW9kZWxzXG4gICAgICBjb25zdCBbZGVzY3JpcHRpb24sIG9iamVjdHMsIHNlbnRpbWVudF0gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIHRoaXMuZ2VuZXJhdGVJbWFnZURlc2NyaXB0aW9uKGJhc2U2NEltYWdlKSxcbiAgICAgICAgdGhpcy5kZXRlY3RPYmplY3RzKGJhc2U2NEltYWdlKSxcbiAgICAgICAgdGhpcy5hbmFseXplSW1hZ2VTZW50aW1lbnQoYmFzZTY0SW1hZ2UpXG4gICAgICBdKVxuXG4gICAgICAvLyBBc3Nlc3MgaW1hZ2UgcXVhbGl0eVxuICAgICAgY29uc3QgcXVhbGl0eSA9IGF3YWl0IHRoaXMuYXNzZXNzSW1hZ2VRdWFsaXR5KGJhc2U2NEltYWdlKVxuICAgICAgXG4gICAgICAvLyBEZXRlY3QgcG90ZW50aWFsIGlzc3Vlc1xuICAgICAgY29uc3QgaXNzdWVzID0gYXdhaXQgdGhpcy5kZXRlY3RJbWFnZUlzc3VlcyhiYXNlNjRJbWFnZSwgb2JqZWN0cylcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgIG9iamVjdHMsXG4gICAgICAgIHNlbnRpbWVudCxcbiAgICAgICAgcXVhbGl0eSxcbiAgICAgICAgaXNzdWVzLFxuICAgICAgICBsb2NhdGlvbjogYXdhaXQgdGhpcy5leHRyYWN0TG9jYXRpb25Gcm9tSW1hZ2UoYmFzZTY0SW1hZ2UpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ltYWdlIGFuYWx5c2lzIGZhaWxlZDonLCBlcnJvcilcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW1hZ2UgYW5hbHlzaXMgc2VydmljZSB1bmF2YWlsYWJsZScpXG4gICAgfVxuICB9XG5cbiAgLy8gTGFuZ3VhZ2UgZGV0ZWN0aW9uIHVzaW5nIEFJXG4gIHByaXZhdGUgYXN5bmMgZGV0ZWN0TGFuZ3VhZ2UodGV4dDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgJ2h0dHBzOi8vYXBpLWluZmVyZW5jZS5odWdnaW5nZmFjZS5jby9tb2RlbHMvZmFjZWJvb2svZmFzdHRleHQtbGFuZ3VhZ2UtaWRlbnRpZmljYXRpb24nLFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5odWdnaW5nRmFjZUtleX1gLFxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgaW5wdXRzOiB0ZXh0IH0pLFxuICAgICAgICB9XG4gICAgICApXG5cbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgICAgcmV0dXJuIHJlc3VsdFswXT8ubGFiZWw/LnJlcGxhY2UoJ19fbGFiZWxfXycsICcnKSB8fCAnZW4nXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0xhbmd1YWdlIGRldGVjdGlvbiBmYWlsZWQ6JywgZXJyb3IpXG4gICAgfVxuICAgIHJldHVybiAnZW4nXG4gIH1cblxuICAvLyBFbmhhbmNlZCBzZW50aW1lbnQgYW5hbHlzaXMgd2l0aCBtdWx0aXBsZSBtb2RlbHNcbiAgcHJpdmF0ZSBhc3luYyBhbmFseXplU2VudGltZW50KHRleHQ6IHN0cmluZywgbGFuZ3VhZ2U6IHN0cmluZyk6IFByb21pc2U8e3NlbnRpbWVudDogc3RyaW5nLCBjb25maWRlbmNlOiBudW1iZXJ9PiB7XG4gICAgY29uc3QgbW9kZWxzID0gW1xuICAgICAgJ2NhcmRpZmZubHAvdHdpdHRlci1yb2JlcnRhLWJhc2Utc2VudGltZW50LWxhdGVzdCcsXG4gICAgICAnbmxwdG93bi9iZXJ0LWJhc2UtbXVsdGlsaW5ndWFsLXVuY2FzZWQtc2VudGltZW50J1xuICAgIF1cblxuICAgIGZvciAoY29uc3QgbW9kZWwgb2YgbW9kZWxzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICAgIGBodHRwczovL2FwaS1pbmZlcmVuY2UuaHVnZ2luZ2ZhY2UuY28vbW9kZWxzLyR7bW9kZWx9YCxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuaHVnZ2luZ0ZhY2VLZXl9YCxcbiAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgaW5wdXRzOiB0ZXh0IH0pLFxuICAgICAgICAgIH1cbiAgICAgICAgKVxuXG4gICAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHJlc3VsdCkgJiYgcmVzdWx0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHRvcFJlc3VsdCA9IHJlc3VsdFswXVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgc2VudGltZW50OiB0aGlzLm5vcm1hbGl6ZVNlbnRpbWVudCh0b3BSZXN1bHQubGFiZWwpLFxuICAgICAgICAgICAgICBjb25maWRlbmNlOiB0b3BSZXN1bHQuc2NvcmVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYFNlbnRpbWVudCBhbmFseXNpcyB3aXRoICR7bW9kZWx9IGZhaWxlZDpgLCBlcnJvcilcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0FsbCBzZW50aW1lbnQgYW5hbHlzaXMgbW9kZWxzIGZhaWxlZCcpXG4gIH1cblxuICAvLyBBZHZhbmNlZCBlbW90aW9uIGFuYWx5c2lzXG4gIHByaXZhdGUgYXN5bmMgYW5hbHl6ZUVtb3Rpb25zKHRleHQ6IHN0cmluZyk6IFByb21pc2U8eyBba2V5OiBzdHJpbmddOiBudW1iZXIgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICAnaHR0cHM6Ly9hcGktaW5mZXJlbmNlLmh1Z2dpbmdmYWNlLmNvL21vZGVscy9qLWhhcnRtYW5uL2Vtb3Rpb24tZW5nbGlzaC1kaXN0aWxyb2JlcnRhLWJhc2UnLFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5odWdnaW5nRmFjZUtleX1gLFxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgaW5wdXRzOiB0ZXh0IH0pLFxuICAgICAgICB9XG4gICAgICApXG5cbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBlbW90aW9ucyA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShlbW90aW9ucykgJiYgZW1vdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IGVtb3Rpb25TY29yZXM6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH0gPSB7fVxuICAgICAgICAgIGVtb3Rpb25zWzBdLmZvckVhY2goKGVtb3Rpb246IGFueSkgPT4ge1xuICAgICAgICAgICAgZW1vdGlvblNjb3Jlc1tlbW90aW9uLmxhYmVsLnRvTG93ZXJDYXNlKCldID0gZW1vdGlvbi5zY29yZVxuICAgICAgICAgIH0pXG4gICAgICAgICAgcmV0dXJuIGVtb3Rpb25TY29yZXNcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFbW90aW9uIGFuYWx5c2lzIGZhaWxlZDonLCBlcnJvcilcbiAgICB9XG4gICAgcmV0dXJuIHt9XG4gIH1cblxuICAvLyBUb3hpY2l0eSBkZXRlY3Rpb25cbiAgcHJpdmF0ZSBhc3luYyBhbmFseXplVG94aWNpdHkodGV4dDogc3RyaW5nKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgJ2h0dHBzOi8vYXBpLWluZmVyZW5jZS5odWdnaW5nZmFjZS5jby9tb2RlbHMvdW5pdGFyeS90b3hpYy1iZXJ0JyxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuaHVnZ2luZ0ZhY2VLZXl9YCxcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGlucHV0czogdGV4dCB9KSxcbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHJlc3VsdCkgJiYgcmVzdWx0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zdCB0b3hpY1Jlc3VsdCA9IHJlc3VsdFswXS5maW5kKChyOiBhbnkpID0+IHIubGFiZWwgPT09ICdUT1hJQycpXG4gICAgICAgICAgcmV0dXJuIHRveGljUmVzdWx0ID8gdG94aWNSZXN1bHQuc2NvcmUgOiAwXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignVG94aWNpdHkgYW5hbHlzaXMgZmFpbGVkOicsIGVycm9yKVxuICAgIH1cbiAgICByZXR1cm4gMFxuICB9XG5cbiAgLy8gVGV4dCBjYXRlZ29yaXphdGlvblxuICBwcml2YXRlIGFzeW5jIGNhdGVnb3JpemVUZXh0KHRleHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgJ2h0dHBzOi8vYXBpLWluZmVyZW5jZS5odWdnaW5nZmFjZS5jby9tb2RlbHMvZmFjZWJvb2svYmFydC1sYXJnZS1tbmxpJyxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuaHVnZ2luZ0ZhY2VLZXl9YCxcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBpbnB1dHM6IHRleHQsXG4gICAgICAgICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgICAgICAgIGNhbmRpZGF0ZV9sYWJlbHM6IFtcbiAgICAgICAgICAgICAgICAnYWNjb21tb2RhdGlvbicsICdmb29kJywgJ3RyYW5zcG9ydGF0aW9uJywgJ2F0dHJhY3Rpb25zJywgXG4gICAgICAgICAgICAgICAgJ3NlcnZpY2UgcXVhbGl0eScsICdjbGVhbmxpbmVzcycsICdzYWZldHknLCAncHJpY2luZycsIFxuICAgICAgICAgICAgICAgICdhY2Nlc3NpYmlsaXR5JywgJ2N1bHR1cmFsIGV4cGVyaWVuY2UnXG4gICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KSxcbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gICAgICAgIHJldHVybiByZXN1bHQubGFiZWxzPy5zbGljZSgwLCAzKSB8fCBbXVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdUZXh0IGNhdGVnb3JpemF0aW9uIGZhaWxlZDonLCBlcnJvcilcbiAgICB9XG4gICAgcmV0dXJuIFtdXG4gIH1cblxuICAvLyBBZHZhbmNlZCBrZXl3b3JkIGV4dHJhY3Rpb24gdXNpbmcgVEYtSURGIGFuZCBORVJcbiAgcHJpdmF0ZSBhc3luYyBleHRyYWN0QWR2YW5jZWRLZXl3b3Jkcyh0ZXh0OiBzdHJpbmcsIGxhbmd1YWdlOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIE5hbWVkIEVudGl0eSBSZWNvZ25pdGlvblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgJ2h0dHBzOi8vYXBpLWluZmVyZW5jZS5odWdnaW5nZmFjZS5jby9tb2RlbHMvZGJtZHovYmVydC1sYXJnZS1jYXNlZC1maW5ldHVuZWQtY29ubGwwMy1lbmdsaXNoJyxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuaHVnZ2luZ0ZhY2VLZXl9YCxcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGlucHV0czogdGV4dCB9KSxcbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgICBjb25zdCBlbnRpdGllczogc3RyaW5nW10gPSBbXVxuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShyZXN1bHQpKSB7XG4gICAgICAgICAgcmVzdWx0LmZvckVhY2goKGVudGl0eTogYW55KSA9PiB7XG4gICAgICAgICAgICBpZiAoZW50aXR5LmVudGl0eV9ncm91cCAmJiBlbnRpdHkud29yZCkge1xuICAgICAgICAgICAgICBlbnRpdGllcy5wdXNoKGVudGl0eS53b3JkLnJlcGxhY2UoJyMjJywgJycpKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gQ29tYmluZSB3aXRoIFRGLUlERiBrZXl3b3Jkc1xuICAgICAgY29uc3QgdGZpZGZLZXl3b3JkcyA9IHRoaXMuZXh0cmFjdFRGSURGS2V5d29yZHModGV4dClcbiAgICAgIFxuICAgICAgcmV0dXJuIFsuLi5uZXcgU2V0KFsuLi5lbnRpdGllcywgLi4udGZpZGZLZXl3b3Jkc10pXS5zbGljZSgwLCAxMClcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignQWR2YW5jZWQga2V5d29yZCBleHRyYWN0aW9uIGZhaWxlZDonLCBlcnJvcilcbiAgICAgIHJldHVybiB0aGlzLmV4dHJhY3RURklERktleXdvcmRzKHRleHQpXG4gICAgfVxuICB9XG5cbiAgLy8gR2VuZXJhdGUgYWN0aW9uYWJsZSBpbnNpZ2h0cyB1c2luZyBBSVxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlQWN0aW9uYWJsZUluc2lnaHRzKHRleHQ6IHN0cmluZywgbGFuZ3VhZ2U6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBjb25zdCBpbnNpZ2h0czogc3RyaW5nW10gPSBbXVxuICAgIFxuICAgIC8vIFJ1bGUtYmFzZWQgaW5zaWdodHMgZm9yIG5vdyAoY2FuIGJlIGVuaGFuY2VkIHdpdGggR1BULTQgbGF0ZXIpXG4gICAgY29uc3QgbG93ZXJjYXNlVGV4dCA9IHRleHQudG9Mb3dlckNhc2UoKVxuICAgIFxuICAgIGlmIChsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdkaXJ0eScpIHx8IGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ3VuY2xlYW4nKSkge1xuICAgICAgaW5zaWdodHMucHVzaCgnSW1tZWRpYXRlIGNsZWFuaW5nIGFuZCBoeWdpZW5lIGltcHJvdmVtZW50IHJlcXVpcmVkJylcbiAgICB9XG4gICAgXG4gICAgaWYgKGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ2V4cGVuc2l2ZScpIHx8IGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ292ZXJwcmljZWQnKSkge1xuICAgICAgaW5zaWdodHMucHVzaCgnUmV2aWV3IHByaWNpbmcgc3RyYXRlZ3kgYW5kIHByb3ZpZGUgdmFsdWUganVzdGlmaWNhdGlvbicpXG4gICAgfVxuICAgIFxuICAgIGlmIChsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdydWRlJykgfHwgbG93ZXJjYXNlVGV4dC5pbmNsdWRlcygndW5wcm9mZXNzaW9uYWwnKSkge1xuICAgICAgaW5zaWdodHMucHVzaCgnU3RhZmYgdHJhaW5pbmcgYW5kIGN1c3RvbWVyIHNlcnZpY2UgaW1wcm92ZW1lbnQgbmVlZGVkJylcbiAgICB9XG4gICAgXG4gICAgaWYgKGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ3Vuc2FmZScpIHx8IGxvd2VyY2FzZVRleHQuaW5jbHVkZXMoJ2Rhbmdlcm91cycpKSB7XG4gICAgICBpbnNpZ2h0cy5wdXNoKCdVUkdFTlQ6IFNhZmV0eSBhc3Nlc3NtZW50IGFuZCBzZWN1cml0eSBtZWFzdXJlcyByZXF1aXJlZCcpXG4gICAgfVxuICAgIFxuICAgIGlmIChsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdiZWF1dGlmdWwnKSB8fCBsb3dlcmNhc2VUZXh0LmluY2x1ZGVzKCdhbWF6aW5nJykpIHtcbiAgICAgIGluc2lnaHRzLnB1c2goJ0xldmVyYWdlIHBvc2l0aXZlIGFzcGVjdHMgaW4gbWFya2V0aW5nIGFuZCBwcm9tb3Rpb24nKVxuICAgIH1cblxuICAgIHJldHVybiBpbnNpZ2h0c1xuICB9XG5cbiAgLy8gQ2FsY3VsYXRlIHVyZ2VuY3kgbGV2ZWxcbiAgcHJpdmF0ZSBjYWxjdWxhdGVVcmdlbmN5KHNlbnRpbWVudDogYW55LCB0b3hpY2l0eTogbnVtYmVyKTogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyB8ICdjcml0aWNhbCcge1xuICAgIGlmICh0b3hpY2l0eSA+IDAuOCB8fCAoc2VudGltZW50Py5zZW50aW1lbnQgPT09ICduZWdhdGl2ZScgJiYgc2VudGltZW50Py5jb25maWRlbmNlID4gMC45KSkge1xuICAgICAgcmV0dXJuICdjcml0aWNhbCdcbiAgICB9XG4gICAgaWYgKHRveGljaXR5ID4gMC42IHx8IChzZW50aW1lbnQ/LnNlbnRpbWVudCA9PT0gJ25lZ2F0aXZlJyAmJiBzZW50aW1lbnQ/LmNvbmZpZGVuY2UgPiAwLjcpKSB7XG4gICAgICByZXR1cm4gJ2hpZ2gnXG4gICAgfVxuICAgIGlmICh0b3hpY2l0eSA+IDAuMyB8fCAoc2VudGltZW50Py5zZW50aW1lbnQgPT09ICduZWdhdGl2ZScgJiYgc2VudGltZW50Py5jb25maWRlbmNlID4gMC41KSkge1xuICAgICAgcmV0dXJuICdtZWRpdW0nXG4gICAgfVxuICAgIHJldHVybiAnbG93J1xuICB9XG5cbiAgLy8gU3BlZWNoIHRvIHRleHQgY29udmVyc2lvblxuICBwcml2YXRlIGFzeW5jIHNwZWVjaFRvVGV4dChhdWRpb0Jsb2I6IEJsb2IpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpXG4gICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCBhdWRpb0Jsb2IsICdhdWRpby53YXYnKVxuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgICAnaHR0cHM6Ly9hcGktaW5mZXJlbmNlLmh1Z2dpbmdmYWNlLmNvL21vZGVscy9vcGVuYWkvd2hpc3Blci1sYXJnZS12MycsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmh1Z2dpbmdGYWNlS2V5fWAsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBib2R5OiBmb3JtRGF0YSxcbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gICAgICAgIHJldHVybiByZXN1bHQudGV4dCB8fCAnJ1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdTcGVlY2ggdG8gdGV4dCBmYWlsZWQ6JywgZXJyb3IpXG4gICAgfVxuICAgIHJldHVybiAnJ1xuICB9XG5cbiAgLy8gVm9pY2UgZW1vdGlvbiBhbmFseXNpc1xuICBwcml2YXRlIGFzeW5jIGFuYWx5emVWb2ljZUVtb3Rpb25zKGF1ZGlvQmxvYjogQmxvYik6IFByb21pc2U8eyBba2V5OiBzdHJpbmddOiBudW1iZXIgfT4ge1xuICAgIC8vIFBsYWNlaG9sZGVyIGZvciB2b2ljZSBlbW90aW9uIGFuYWx5c2lzXG4gICAgLy8gSW4gcHJvZHVjdGlvbiwgdGhpcyB3b3VsZCB1c2Ugc3BlY2lhbGl6ZWQgYXVkaW8gZW1vdGlvbiByZWNvZ25pdGlvbiBtb2RlbHNcbiAgICByZXR1cm4ge1xuICAgICAgY2FsbTogMC4zLFxuICAgICAgZXhjaXRlZDogMC4yLFxuICAgICAgZnJ1c3RyYXRlZDogMC4xLFxuICAgICAgaGFwcHk6IDAuNFxuICAgIH1cbiAgfVxuXG4gIC8vIERldGVybWluZSBzcGVha2VyIHRvbmUgZnJvbSB2b2ljZSBlbW90aW9uc1xuICBwcml2YXRlIGRldGVybWluZVNwZWFrZXJUb25lKGVtb3Rpb25zOiB7IFtrZXk6IHN0cmluZ106IG51bWJlciB9KTogJ2NhbG0nIHwgJ2V4Y2l0ZWQnIHwgJ2ZydXN0cmF0ZWQnIHwgJ2FuZ3J5JyB8ICdoYXBweScge1xuICAgIGNvbnN0IG1heEVtb3Rpb24gPSBPYmplY3QuZW50cmllcyhlbW90aW9ucykucmVkdWNlKChhLCBiKSA9PiBhWzFdID4gYlsxXSA/IGEgOiBiKVxuICAgIHJldHVybiBtYXhFbW90aW9uWzBdIGFzIGFueSB8fCAnY2FsbSdcbiAgfVxuXG4gIC8vIEltYWdlIGRlc2NyaXB0aW9uIGdlbmVyYXRpb25cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUltYWdlRGVzY3JpcHRpb24oYmFzZTY0SW1hZ2U6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICAgICdodHRwczovL2FwaS1pbmZlcmVuY2UuaHVnZ2luZ2ZhY2UuY28vbW9kZWxzL1NhbGVzZm9yY2UvYmxpcC1pbWFnZS1jYXB0aW9uaW5nLWxhcmdlJyxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuaHVnZ2luZ0ZhY2VLZXl9YCxcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGlucHV0czogYmFzZTY0SW1hZ2UgfSksXG4gICAgICAgIH1cbiAgICAgIClcblxuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgICByZXR1cm4gcmVzdWx0WzBdPy5nZW5lcmF0ZWRfdGV4dCB8fCAnVW5hYmxlIHRvIGdlbmVyYXRlIGRlc2NyaXB0aW9uJ1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdJbWFnZSBkZXNjcmlwdGlvbiBmYWlsZWQ6JywgZXJyb3IpXG4gICAgfVxuICAgIHJldHVybiAnSW1hZ2UgYW5hbHlzaXMgdW5hdmFpbGFibGUnXG4gIH1cblxuICAvLyBPYmplY3QgZGV0ZWN0aW9uIGluIGltYWdlc1xuICBwcml2YXRlIGFzeW5jIGRldGVjdE9iamVjdHMoYmFzZTY0SW1hZ2U6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgJ2h0dHBzOi8vYXBpLWluZmVyZW5jZS5odWdnaW5nZmFjZS5jby9tb2RlbHMvZmFjZWJvb2svZGV0ci1yZXNuZXQtNTAnLFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5odWdnaW5nRmFjZUtleX1gLFxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgaW5wdXRzOiBiYXNlNjRJbWFnZSB9KSxcbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgICBpZiAocmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gICAgICAgIHJldHVybiByZXN1bHQubWFwKChvYmo6IGFueSkgPT4gb2JqLmxhYmVsKS5zbGljZSgwLCAxMClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignT2JqZWN0IGRldGVjdGlvbiBmYWlsZWQ6JywgZXJyb3IpXG4gICAgfVxuICAgIHJldHVybiBbXVxuICB9XG5cbiAgLy8gSW1hZ2Ugc2VudGltZW50IGFuYWx5c2lzXG4gIHByaXZhdGUgYXN5bmMgYW5hbHl6ZUltYWdlU2VudGltZW50KGJhc2U2NEltYWdlOiBzdHJpbmcpOiBQcm9taXNlPCdwb3NpdGl2ZScgfCAnbmVnYXRpdmUnIHwgJ25ldXRyYWwnPiB7XG4gICAgLy8gUGxhY2Vob2xkZXIgLSB3b3VsZCB1c2Ugc3BlY2lhbGl6ZWQgaW1hZ2Ugc2VudGltZW50IG1vZGVsc1xuICAgIHJldHVybiAnbmV1dHJhbCdcbiAgfVxuXG4gIC8vIEFzc2VzcyBpbWFnZSBxdWFsaXR5XG4gIHByaXZhdGUgYXN5bmMgYXNzZXNzSW1hZ2VRdWFsaXR5KGJhc2U2NEltYWdlOiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcj4ge1xuICAgIC8vIFBsYWNlaG9sZGVyIC0gd291bGQgdXNlIGltYWdlIHF1YWxpdHkgYXNzZXNzbWVudCBtb2RlbHNcbiAgICByZXR1cm4gTWF0aC5yYW5kb20oKSAqIDAuMyArIDAuNyAvLyBSYW5kb20gcXVhbGl0eSBiZXR3ZWVuIDAuNy0xLjBcbiAgfVxuXG4gIC8vIERldGVjdCBpc3N1ZXMgaW4gaW1hZ2VzXG4gIHByaXZhdGUgYXN5bmMgZGV0ZWN0SW1hZ2VJc3N1ZXMoYmFzZTY0SW1hZ2U6IHN0cmluZywgb2JqZWN0czogc3RyaW5nW10pOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgY29uc3QgaXNzdWVzOiBzdHJpbmdbXSA9IFtdXG4gICAgXG4gICAgLy8gUnVsZS1iYXNlZCBpc3N1ZSBkZXRlY3Rpb25cbiAgICBpZiAob2JqZWN0cy5pbmNsdWRlcygndHJhc2gnKSB8fCBvYmplY3RzLmluY2x1ZGVzKCdnYXJiYWdlJykpIHtcbiAgICAgIGlzc3Vlcy5wdXNoKCdDbGVhbmxpbmVzcyBpc3N1ZSBkZXRlY3RlZCcpXG4gICAgfVxuICAgIFxuICAgIGlmIChvYmplY3RzLmluY2x1ZGVzKCdkYW1hZ2UnKSB8fCBvYmplY3RzLmluY2x1ZGVzKCdicm9rZW4nKSkge1xuICAgICAgaXNzdWVzLnB1c2goJ0luZnJhc3RydWN0dXJlIGRhbWFnZSBkZXRlY3RlZCcpXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBpc3N1ZXNcbiAgfVxuXG4gIC8vIEV4dHJhY3QgbG9jYXRpb24gZnJvbSBpbWFnZSBtZXRhZGF0YVxuICBwcml2YXRlIGFzeW5jIGV4dHJhY3RMb2NhdGlvbkZyb21JbWFnZShiYXNlNjRJbWFnZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmcgfCB1bmRlZmluZWQ+IHtcbiAgICAvLyBQbGFjZWhvbGRlciAtIHdvdWxkIGV4dHJhY3QgR1BTIGRhdGEgZnJvbSBFWElGIG9yIHVzZSBpbWFnZSByZWNvZ25pdGlvblxuICAgIHJldHVybiB1bmRlZmluZWRcbiAgfVxuXG4gIC8vIFV0aWxpdHkgZnVuY3Rpb25zXG4gIHByaXZhdGUgYXN5bmMgYmxvYlRvQmFzZTY0KGJsb2I6IEJsb2IpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gICAgICByZWFkZXIub25sb2FkZW5kID0gKCkgPT4gcmVzb2x2ZShyZWFkZXIucmVzdWx0IGFzIHN0cmluZylcbiAgICAgIHJlYWRlci5vbmVycm9yID0gcmVqZWN0XG4gICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChibG9iKVxuICAgIH0pXG4gIH1cblxuICBwcml2YXRlIG5vcm1hbGl6ZVNlbnRpbWVudChsYWJlbDogc3RyaW5nKTogJ3Bvc2l0aXZlJyB8ICduZWdhdGl2ZScgfCAnbmV1dHJhbCcge1xuICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSBsYWJlbC50b0xvd2VyQ2FzZSgpXG4gICAgaWYgKG5vcm1hbGl6ZWQuaW5jbHVkZXMoJ3Bvc2l0aXZlJykgfHwgbm9ybWFsaXplZC5pbmNsdWRlcygncG9zJykpIHJldHVybiAncG9zaXRpdmUnXG4gICAgaWYgKG5vcm1hbGl6ZWQuaW5jbHVkZXMoJ25lZ2F0aXZlJykgfHwgbm9ybWFsaXplZC5pbmNsdWRlcygnbmVnJykpIHJldHVybiAnbmVnYXRpdmUnXG4gICAgcmV0dXJuICduZXV0cmFsJ1xuICB9XG5cbiAgcHJpdmF0ZSBleHRyYWN0VEZJREZLZXl3b3Jkcyh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3Qgc3RvcFdvcmRzID0gbmV3IFNldChbXG4gICAgICAndGhlJywgJ2EnLCAnYW4nLCAnYW5kJywgJ29yJywgJ2J1dCcsICdpbicsICdvbicsICdhdCcsICd0bycsICdmb3InLCAnb2YnLCAnd2l0aCcsICdieScsXG4gICAgICAnaXMnLCAnd2FzJywgJ2FyZScsICd3ZXJlJywgJ2JlJywgJ2JlZW4nLCAnaGF2ZScsICdoYXMnLCAnaGFkJywgJ2RvJywgJ2RvZXMnLCAnZGlkJyxcbiAgICAgICd3aWxsJywgJ3dvdWxkJywgJ2NvdWxkJywgJ3Nob3VsZCcsICdtYXknLCAnbWlnaHQnLCAnbXVzdCcsICdjYW4nLCAndGhpcycsICd0aGF0JyxcbiAgICAgICd0aGVzZScsICd0aG9zZScsICdpJywgJ3lvdScsICdoZScsICdzaGUnLCAnaXQnLCAnd2UnLCAndGhleScsICdtZScsICdoaW0nLCAnaGVyJywgJ3VzJywgJ3RoZW0nXG4gICAgXSlcbiAgICBcbiAgICBjb25zdCB3b3JkcyA9IHRleHQudG9Mb3dlckNhc2UoKVxuICAgICAgLnJlcGxhY2UoL1teXFx3XFxzXS9nLCAnJylcbiAgICAgIC5zcGxpdCgvXFxzKy8pXG4gICAgICAuZmlsdGVyKHdvcmQgPT4gd29yZC5sZW5ndGggPiAyICYmICFzdG9wV29yZHMuaGFzKHdvcmQpKVxuICAgIFxuICAgIGNvbnN0IHdvcmRDb3VudDogeyBba2V5OiBzdHJpbmddOiBudW1iZXIgfSA9IHt9XG4gICAgd29yZHMuZm9yRWFjaCh3b3JkID0+IHtcbiAgICAgIHdvcmRDb3VudFt3b3JkXSA9ICh3b3JkQ291bnRbd29yZF0gfHwgMCkgKyAxXG4gICAgfSlcbiAgICBcbiAgICByZXR1cm4gT2JqZWN0LmVudHJpZXMod29yZENvdW50KVxuICAgICAgLnNvcnQoKFssYV0sIFssYl0pID0+IGIgLSBhKVxuICAgICAgLnNsaWNlKDAsIDUpXG4gICAgICAubWFwKChbd29yZF0pID0+IHdvcmQpXG4gIH1cblxuICBwcml2YXRlIGZhbGxiYWNrQW5hbHlzaXModGV4dDogc3RyaW5nLCBsYW5ndWFnZTogc3RyaW5nKTogQUlBbmFseXNpc1Jlc3VsdCB7XG4gICAgLy8gU2ltcGxlIHJ1bGUtYmFzZWQgZmFsbGJhY2tcbiAgICBjb25zdCBwb3NpdGl2ZVdvcmRzID0gWydnb29kJywgJ2dyZWF0JywgJ2V4Y2VsbGVudCcsICdhbWF6aW5nJywgJ3dvbmRlcmZ1bCcsICdiZWF1dGlmdWwnLCAnbG92ZScsICdwZXJmZWN0J11cbiAgICBjb25zdCBuZWdhdGl2ZVdvcmRzID0gWydiYWQnLCAndGVycmlibGUnLCAnYXdmdWwnLCAnaG9ycmlibGUnLCAnaGF0ZScsICd3b3JzdCcsICdkaXNhcHBvaW50aW5nJywgJ3Bvb3InXVxuICAgIFxuICAgIGNvbnN0IHdvcmRzID0gdGV4dC50b0xvd2VyQ2FzZSgpLnNwbGl0KC9cXHMrLylcbiAgICBjb25zdCBwb3NpdGl2ZUNvdW50ID0gd29yZHMuZmlsdGVyKHdvcmQgPT4gcG9zaXRpdmVXb3Jkcy5pbmNsdWRlcyh3b3JkKSkubGVuZ3RoXG4gICAgY29uc3QgbmVnYXRpdmVDb3VudCA9IHdvcmRzLmZpbHRlcih3b3JkID0+IG5lZ2F0aXZlV29yZHMuaW5jbHVkZXMod29yZCkpLmxlbmd0aFxuICAgIFxuICAgIGxldCBzZW50aW1lbnQ6ICdwb3NpdGl2ZScgfCAnbmVnYXRpdmUnIHwgJ25ldXRyYWwnID0gJ25ldXRyYWwnXG4gICAgbGV0IGNvbmZpZGVuY2UgPSAwLjVcbiAgICBcbiAgICBpZiAocG9zaXRpdmVDb3VudCA+IG5lZ2F0aXZlQ291bnQpIHtcbiAgICAgIHNlbnRpbWVudCA9ICdwb3NpdGl2ZSdcbiAgICAgIGNvbmZpZGVuY2UgPSBNYXRoLm1pbigwLjgsIDAuNSArIChwb3NpdGl2ZUNvdW50IC0gbmVnYXRpdmVDb3VudCkgKiAwLjEpXG4gICAgfSBlbHNlIGlmIChuZWdhdGl2ZUNvdW50ID4gcG9zaXRpdmVDb3VudCkge1xuICAgICAgc2VudGltZW50ID0gJ25lZ2F0aXZlJ1xuICAgICAgY29uZmlkZW5jZSA9IE1hdGgubWluKDAuOCwgMC41ICsgKG5lZ2F0aXZlQ291bnQgLSBwb3NpdGl2ZUNvdW50KSAqIDAuMSlcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHNlbnRpbWVudCxcbiAgICAgIGNvbmZpZGVuY2UsXG4gICAgICBlbW90aW9uczoge1xuICAgICAgICBqb3k6IHNlbnRpbWVudCA9PT0gJ3Bvc2l0aXZlJyA/IGNvbmZpZGVuY2UgKiAwLjggOiAwLjEsXG4gICAgICAgIGFuZ2VyOiBzZW50aW1lbnQgPT09ICduZWdhdGl2ZScgPyBjb25maWRlbmNlICogMC42IDogMC4xLFxuICAgICAgICBzYWRuZXNzOiBzZW50aW1lbnQgPT09ICduZWdhdGl2ZScgPyBjb25maWRlbmNlICogMC40IDogMC4xLFxuICAgICAgfSxcbiAgICAgIGtleXdvcmRzOiB0aGlzLmV4dHJhY3RURklERktleXdvcmRzKHRleHQpLFxuICAgICAgbGFuZ3VhZ2U6IGxhbmd1YWdlIHx8ICdlbicsXG4gICAgICB0b3hpY2l0eTogMCxcbiAgICAgIHVyZ2VuY3k6ICdsb3cnLFxuICAgICAgY2F0ZWdvcmllczogW10sXG4gICAgICBhY3Rpb25hYmxlSW5zaWdodHM6IFtdXG4gICAgfVxuICB9XG59XG5cbi8vIFNpbmdsZXRvbiBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IGFpU2VydmljZSA9IG5ldyBBZHZhbmNlZEFJU2VydmljZSgpXG4iXSwibmFtZXMiOlsiQWR2YW5jZWRBSVNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImh1Z2dpbmdGYWNlS2V5IiwicHJvY2VzcyIsImVudiIsIkhVR0dJTkdGQUNFX0FQSV9LRVkiLCJvcGVuQUlLZXkiLCJPUEVOQUlfQVBJX0tFWSIsImdvb2dsZUNsb3VkS2V5IiwiR09PR0xFX0NMT1VEX0FQSV9LRVkiLCJhbmFseXplVGV4dCIsInRleHQiLCJsYW5ndWFnZSIsImRldGVjdGVkTGFuZ3VhZ2UiLCJkZXRlY3RMYW5ndWFnZSIsInNlbnRpbWVudFJlc3VsdCIsImVtb3Rpb25SZXN1bHQiLCJ0b3hpY2l0eVJlc3VsdCIsImNhdGVnb3J5UmVzdWx0IiwiUHJvbWlzZSIsImFsbFNldHRsZWQiLCJhbmFseXplU2VudGltZW50IiwiYW5hbHl6ZUVtb3Rpb25zIiwiYW5hbHl6ZVRveGljaXR5IiwiY2F0ZWdvcml6ZVRleHQiLCJrZXl3b3JkcyIsImV4dHJhY3RBZHZhbmNlZEtleXdvcmRzIiwiaW5zaWdodHMiLCJnZW5lcmF0ZUFjdGlvbmFibGVJbnNpZ2h0cyIsInVyZ2VuY3kiLCJjYWxjdWxhdGVVcmdlbmN5Iiwic3RhdHVzIiwidmFsdWUiLCJzZW50aW1lbnQiLCJjb25maWRlbmNlIiwiZW1vdGlvbnMiLCJ0b3hpY2l0eSIsImNhdGVnb3JpZXMiLCJhY3Rpb25hYmxlSW5zaWdodHMiLCJlcnJvciIsImNvbnNvbGUiLCJmYWxsYmFja0FuYWx5c2lzIiwiYW5hbHl6ZVZvaWNlIiwiYXVkaW9CbG9iIiwidHJhbnNjcmlwdGlvbiIsInNwZWVjaFRvVGV4dCIsInRleHRBbmFseXNpcyIsInZvaWNlRW1vdGlvbnMiLCJhbmFseXplVm9pY2VFbW90aW9ucyIsInNwZWFrZXJUb25lIiwiZGV0ZXJtaW5lU3BlYWtlclRvbmUiLCJFcnJvciIsImFuYWx5emVJbWFnZSIsImltYWdlQmxvYiIsImJhc2U2NEltYWdlIiwiYmxvYlRvQmFzZTY0IiwiZGVzY3JpcHRpb24iLCJvYmplY3RzIiwiYWxsIiwiZ2VuZXJhdGVJbWFnZURlc2NyaXB0aW9uIiwiZGV0ZWN0T2JqZWN0cyIsImFuYWx5emVJbWFnZVNlbnRpbWVudCIsInF1YWxpdHkiLCJhc3Nlc3NJbWFnZVF1YWxpdHkiLCJpc3N1ZXMiLCJkZXRlY3RJbWFnZUlzc3VlcyIsImxvY2F0aW9uIiwiZXh0cmFjdExvY2F0aW9uRnJvbUltYWdlIiwicmVzcG9uc2UiLCJmZXRjaCIsImhlYWRlcnMiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImlucHV0cyIsIm9rIiwicmVzdWx0IiwianNvbiIsImxhYmVsIiwicmVwbGFjZSIsIm1vZGVscyIsIm1vZGVsIiwiQXJyYXkiLCJpc0FycmF5IiwibGVuZ3RoIiwidG9wUmVzdWx0Iiwibm9ybWFsaXplU2VudGltZW50Iiwic2NvcmUiLCJlbW90aW9uU2NvcmVzIiwiZm9yRWFjaCIsImVtb3Rpb24iLCJ0b0xvd2VyQ2FzZSIsInRveGljUmVzdWx0IiwiZmluZCIsInIiLCJwYXJhbWV0ZXJzIiwiY2FuZGlkYXRlX2xhYmVscyIsImxhYmVscyIsInNsaWNlIiwiZW50aXRpZXMiLCJlbnRpdHkiLCJlbnRpdHlfZ3JvdXAiLCJ3b3JkIiwicHVzaCIsInRmaWRmS2V5d29yZHMiLCJleHRyYWN0VEZJREZLZXl3b3JkcyIsIlNldCIsImxvd2VyY2FzZVRleHQiLCJpbmNsdWRlcyIsImZvcm1EYXRhIiwiRm9ybURhdGEiLCJhcHBlbmQiLCJjYWxtIiwiZXhjaXRlZCIsImZydXN0cmF0ZWQiLCJoYXBweSIsIm1heEVtb3Rpb24iLCJPYmplY3QiLCJlbnRyaWVzIiwicmVkdWNlIiwiYSIsImIiLCJnZW5lcmF0ZWRfdGV4dCIsIm1hcCIsIm9iaiIsIk1hdGgiLCJyYW5kb20iLCJ1bmRlZmluZWQiLCJibG9iIiwicmVzb2x2ZSIsInJlamVjdCIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWRlbmQiLCJvbmVycm9yIiwicmVhZEFzRGF0YVVSTCIsIm5vcm1hbGl6ZWQiLCJzdG9wV29yZHMiLCJ3b3JkcyIsInNwbGl0IiwiZmlsdGVyIiwiaGFzIiwid29yZENvdW50Iiwic29ydCIsInBvc2l0aXZlV29yZHMiLCJuZWdhdGl2ZVdvcmRzIiwicG9zaXRpdmVDb3VudCIsIm5lZ2F0aXZlQ291bnQiLCJtaW4iLCJqb3kiLCJhbmdlciIsInNhZG5lc3MiLCJhaVNlcnZpY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/ai-services.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.2.32_react-dom@18.3.1_react@18.3.1__react@18.3.1"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@14.2.32_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ffeedback%2Froute&page=%2Fapi%2Ffeedback%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ffeedback%2Froute.ts&appDir=C%3A%5CUsers%5CPrachi%5CDesktop%5CSIH%202025%5CTourism-Jharkhand%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CPrachi%5CDesktop%5CSIH%202025%5CTourism-Jharkhand&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();